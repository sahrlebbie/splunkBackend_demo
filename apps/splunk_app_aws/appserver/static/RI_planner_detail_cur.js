require(["app/splunk_app_aws/js/libs/jquery-ui","splunkjs/mvc","app/splunk_app_aws/js/libs/underscore","app/splunk_app_aws/js/libs/backbone","app/splunk_app_aws/js/swc-aws/index","app/splunk_app_aws/js/libs/jquery","splunkjs/mvc/searchmanager","splunkjs/mvc/tokenforwarder","splunkjs/mvc/simplexml/ready!","splunkjs/mvc/tableview","splunkjs/mvc/simplesplunkview","app/splunk_app_aws/js/swc-aws/index_for_visualization","splunkjs/mvc/multidropdownview"],function(t,e,n,a,i,r,o,s,l,c,d,u,p){return function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return t[a].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var a,i;n.p=function(){function t(){for(var t,n,a="",i=0,r=arguments.length;i<r;i++)t=arguments[i].toString(),n=t.length,n>1&&"/"==t.charAt(n-1)&&(t=t.substring(0,n-1)),a+="/"!=t.charAt(0)?"/"+t:t;if("/"!=a){var o=a.split("/"),s=o[1];if("static"==s||"modules"==s){var l=a.substring(s.length+2,a.length);a="/"+s,window.$C.BUILD_NUMBER&&(a+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(a+="."+window.$C.BUILD_PUSH_NUMBER),"app"==o[2]&&(a+=":"+e("APP_BUILD",0)),a+="/"+l}}var c=e("MRSPARKLE_ROOT_PATH","/"),d=e("DJANGO_ROOT_PATH",""),u=e("LOCALE","en-US"),p="";return p=d&&a.substring(0,d.length)===d?a.replace(d,d+"/"+u.toLowerCase()):"/"+u+a,""==c||"/"==c?p:c+p}function e(t,e){if(window.$C&&window.$C.hasOwnProperty(t))return window.$C[t];if(void 0!==e)return e;throw new Error("getConfigValue - "+t+" not set, no default provided")}return t("/static/app/splunk_app_aws")+"/"}(),a=[n(1),n(4),n(2),n(98),n(99),n(86),n(100),n(101),n(81),n(80),n(48),n(96),n(53)],i=function(t,e,n,a,i,r,o,s,l,c){"use strict";var d=new a,u=n.Components.get("default"),p=u.get("earliest"),h=u.get("latest");new r({el:$("#headerContainer"),model:d}).render();var f=new o({model:d}),A=new s({el:"#"+l.CHART_CONTAINER_ID,model:d}).render();new i(d,p,h),u.on("change:base",function(){d.changeSingleData(u.get("base"))}),u.on("change:payment",f.formatData.bind(f)),A.on(l.EVENT.RESET,function(){u.set("earliest",p),u.set("latest",h),d.changeSingleData(u.get("base"))}),A.on(l.EVENT.DRAG_POINT,d.dragPointToModifySingleData.bind(d)),$("#"+l.CHART_CONTAINER_ID).on(l.EVENT.SELECT_TIME,function(t,e,n){var a=c.timeToIndex(e),i=c.timeToIndex(n),r=c.start.getTime()+a*l.ONE_DAY_MIS,o=c.start.getTime()+(i+1)*l.ONE_DAY_MIS-1;u.set("earliest",r*l.TIMESTAMP_TO_SPLUNK_TIME_COEF),u.set("latest",o*l.TIMESTAMP_TO_SPLUNK_TIME_COEF),d.selectTimeToModifySingleData(a,i)})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(e,n){e.exports=t},function(t,n){t.exports=e},,function(t,e){t.exports=n},function(t,e){t.exports=a},function(t,e,n){var a,i,r=function(){function t(t,e){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){i=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();a=[n(4),n(7),n(8)],i=function(t,e,n){"use strict";var a=e.moment,i={generateIHSPL:function(e){var i=e.aws_account_id,o=e.region,s=e.instance_type,l=e.platform,c=e.tenancy,d=e.base,u=e.normalFactor,p=e.dedupSpl,h=n.RI,f=o+"*",A=s,g="";if(this.checkSizeFlexibility(l,c)){h=n.SIZE_FLEXIBILITY_RI;var m=s.split("."),_=r(m,2),y=_[0];_[1];A=y+"*",g=u}var v={dedupSpl:p,region:o,platform:l,tenancy:c,accountId:i,location:f,type:A,refer:g},C=t.template(h,$.extend({slice:"h",name:"current_ih"},v));if("prediction"===d){var b=a().add(1,"y").isLeapYear(),E=n.ONE_YEAR_DAY+(b?1:0);C+=t.template(n.PREDICT_RI,{oneYearHour:E*n.ONE_DAY_HOUR,oneYearDay:E,instanceHourSPL:t.template(h,$.extend({slice:"d",name:"current_d"},v))})}return C},generateRecommSPL:function(t){var e=t.base,n=t.payment,a=t.instance_type,i=t.region,r=t.platform,o=t.tenancy;return"| rirecommendation "+e+" "+i+" "+a+" "+n+' "'+r+'" "'+o+'"'},generateRISPL:function(t){return i.generateIHSPL(t)+i.generateRecommSPL(t)},calRI:function(t,e,n){if(0===n)return 0;var a=t.slice().sort(function(t,e){return t-e}),i=parseInt(e/n*t.length),r=Math.min(Math.max(t.length-i-1,0),t.length-1);return parseInt(Math.round(a[r]))},calRICost:function(t,e,a,i){var r=t.map(function(t){return parseFloat(t)}),o=r.reduce(function(t,e){return t+e},0),s=r.reduce(function(t,n){var a=n-e;return t+(a>0?a:0)},0),l=o*i,c=s*i+e*a*t.length;return t.length<n.ONE_YEAR_DAY*n.ONE_DAY_HOUR&&(l=parseInt(Math.round(l/t.length*n.ONE_YEAR_DAY*n.ONE_DAY_HOUR)),c=parseInt(Math.round(c/t.length*n.ONE_YEAR_DAY*n.ONE_DAY_HOUR)),s=parseInt(Math.round(s/t.length*n.ONE_YEAR_DAY*n.ONE_DAY_HOUR))),{onDemandCost:l,riCost:c,totalUnCoveredHours:s}},timeToIndex:function(t){return Math.floor((t-i.start.getTime())/n.ONE_DAY_MIS)},addPlotLine:function(t,e,n,a,i,r){var o={color:i,dashStyle:"shortdot",value:a,width:2,id:e,label:{rotation:0,text:n}};$.extend(o.label,r),t.addPlotLine(o)},timeToXText:function(t){return a(t).format("MMM DD,YYYY")},buildCacheId:function(t,e,n){var a=[n.aws_account_id,n.region,n.platform,n.tenancy,n.instance_type,t,e,n.regionLabel,n.platformLabel,n.tenancyLabel];return a.join("_")},_hoursWeightCmp:function(t,e){if(t.diff!==e.diff)return t.diff>e.diff?-1:1;if(t.value===e.value)return 0;var n=1,a=0,i=0;t.value>e.value?(n=-1,a=t.value,i=e.value):(a=e.value,i=t.value);var r=i/a,o=Math.floor(i+1)/(a<1?1:Math.floor(a)),s=Math.floor(i)/Math.floor(a+1),l=Math.abs(o-r),c=Math.abs(s-r);return l===c?0:l<c?n*-1:1*n},distributeDayAccordingHour:function(t,e){var a=this;if(0===t.length||0===e.length||t.length!==e.length/n.ONE_DAY_HOUR)return[];for(var i=Array.apply(null,Array(t.length*n.ONE_DAY_HOUR)).map(Number.prototype.valueOf,0),r=function(r){var o=Math.round(t[r]);if(0===o)return"continue";var s=o,l=[],c=e.slice(r*n.ONE_DAY_HOUR,(r+1)*n.ONE_DAY_HOUR),d=c.reduce(function(t,e){return t+e},0);c=c.map(function(t){return 0===d?1/n.ONE_DAY_HOUR:t/d});for(var u=0;u<n.ONE_DAY_HOUR;u++){i[r*n.ONE_DAY_HOUR+u]=Math.floor(c[u]*o);var p=c[u]*o-Math.floor(c[u]*o);s-=i[r*n.ONE_DAY_HOUR+u],l.push({index:u,diff:p,value:i[r*n.ONE_DAY_HOUR+u]})}if(s>0)for(l.sort(a._hoursWeightCmp);s>0&&l.length>0;)i[r*n.ONE_DAY_HOUR+l.shift().index]+=1,s-=1},o=0;o<t.length;o++){r(o)}return i},accumulateToMap:function(e,n,a){a=parseFloat(a),t.isNaN(a)&&(a=0);for(var i=e,r=0;r<n.length;r++)n[r]in i?r==n.length-1&&(i[n[r]]+=a):r==n.length-1?i[n[r]]=a:i[n[r]]={},i=i[n[r]]},getValueFromMap:function(t,e){for(var n=t,a=0;a<e.length;a++){if(!(e[a]in n))return 0;n=n[e[a]]}return n},checkSizeFlexibility:function(t,e){return"Linux"==t&&"On Demand"==e}};return i}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=i},function(t,e,n){function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i,r;i=[n(9)],r=function(t){var e;return e={ONE_YEAR_DAY:365,ONE_DAY_HOUR:24,ONE_HOUR_SECOND:3600,ONE_YEAR_MONTH:12,ONE_DAY_MIS:864e5,ONE_HOUR_MIS:36e5,TIMESTAMP_TO_SPLUNK_TIME_COEF:.001,DEFAULT_SMALLEST_SIZE:"small",CHART_CONTAINER_ID:"chartContainer",DEDUP_PREFIX:"instance_hour.",EVENT:{DRAG_POINT:"point",SELECT_TIME:"time",RESET:"reset"},NO_DESCRIPTION_MESSAGE:"It requires description data to get existing reserved instance information.",PARAM:'| tstats `aws-data-model-acceleration` count FROM datamodel=Instance_Hour where instance_hour.AvailabilityZone!="Unspecified"  by instance_hour.LinkedAccountId instance_hour.instance_type instance_hour.platform instance_hour.tenancy instance_hour.AvailabilityZone | rename instance_hour.AvailabilityZone as availability_zone, instance_hour.LinkedAccountId as aws_account_id,  instance_hour.instance_type as instance_type, instance_hour.platform as platform, instance_hour.tenancy as tenancy | eval availability_zone_len=len(availability_zone), region=substr(availability_zone, 0, availability_zone_len-1)| lookup regions region OUTPUT label as regionLabel | lookup ri_billing_to_description billing as platform OUTPUT description as platformLabel | lookup ri_billing_to_description billing as tenancy OUTPUT description as tenancyLabel| stats count by aws_account_id, region, platform, tenancy, instance_type, regionLabel, platformLabel, tenancyLabel',RI:'| tstats `aws-data-model-acceleration` count as <%=name %> FROM datamodel=Instance_Hour where <%= dedupSpl %> AND instance_hour.LinkedAccountId="<%= accountId %>"  AND instance_hour.AvailabilityZone="<%= location %>" AND instance_hour.instance_type="<%= type %>"  AND instance_hour.platform="<%= platform %>" AND instance_hour.tenancy="<%= tenancy %>" by _time span=1h | timechart span=1<%=slice %> sum(<%=name %>) as <%=name %> | fillnull',SIZE_FLEXIBILITY_RI:'| tstats `aws-data-model-acceleration` count FROM datamodel=Instance_Hour where <%= dedupSpl %> AND instance_hour.LinkedAccountId="<%= accountId %>" AND instance_hour.AvailabilityZone="<%= location %>" AND instance_hour.instance_type="<%= type %>"  AND instance_hour.platform="<%= platform %>" AND instance_hour.tenancy="<%= tenancy %>" by instance_hour.instance_type, _time span=1h | rename instance_hour.instance_type as instance_type | eval size=split(instance_type, "."), size=mvindex(size, 1)| lookup ri_normal_factor size OUTPUT factor | eval unit = count * factor / <%= refer %> | timechart span=1<%=slice %> sum(unit) as <%= name %> | fillnull',BILLING_REPORT_ENDTIME:'| inputlookup billing_report_s3key | search eventtype="aws_billing_detail_report" | rex field=source ".*aws-billing-detailed-line-items-.*(?<timestr>\\d{4}-\\d{2}).csv.zip" | sort 0 - timestr',PREDICT_RI:"| predict current_ih as recommended_ih future_timespan=<%= oneYearHour %> | appendcols [<%= instanceHourSPL %> | predict current_d as recommended_d future_timespan=<%= oneYearDay %> | eval d_time=_time]",BOUGHT_RI:'`aws-description-resource("*", "*", "ec2_reserved_instances")` | search state="active" | stats sum(instance_count) as instance_count by aws_account_id, region, description, instance_tenancy, Scope, instance_type | rename description as platform, instance_tenancy as tenancy',FLEXIBILITY_FAMILY_INFO:'| inputlookup price | append [|inputlookup cn_price] | where os="Linux" AND tenancy="Shared" | sort on_demand_hourly | eval instance_type=split(instance_type,"."), family=mvindex(instance_type,0), size=mvindex(instance_type,1) | fields region, family, size | mvcombine size',NORMAL_FACTOR:"| inputlookup ri_normal_factor"},a(e,"EVENT",{DRAG_POINT:"point",SELECT_TIME:"time",RESET:"reset"}),a(e,"TABLE",{SORT_INDEX:[8,7,6],EXISTING_RI_INDEX:6,OPTIMAL_RI_INDEX:7,YEARLY_SAVING_INDEX:8,MESSAGE_INDEX:9,MESSAGE:"Details",ITEM_NAME:{SINGLE:"item",PLURAL:"items"},columnName:["","Account ID","Region","Platform","Tenancy","Instance type","Existing RIs","Optimal RIs","Estimated yearly savings","Details"],columnType:[["expand"],["sort"],["sort"],["sort"],["sort"],["sort"],["sort","tooltip"],["sort","headerTooltip","tooltip"],["sort"],["tooltip","drilldown"]],headerParams:{"Optimal RIs":{tooltipTemplate:t}},footerParams:{"":{colspan:8},"Estimated yearly savings":{colspan:2}},columnParams:{Details:{tooltipPlacement:"top",tooltipOnClick:"return false;"},"Existing RIs":{tooltipPlacement:"top",tooltipOnClick:"return false;"},"Optimal RIs":{tooltipPlacement:"top",tooltipOnClick:"return false;"}}}),a(e,"FILTERS",{BASE_OPTIONS:[{value:"history",label:"History"},{value:"prediction",label:"Prediction"}],PAYMENT_OPTIONS:[{value:"all",label:"All upfront"},{value:"partial",label:"Partial upfront"},{value:"no",label:"No upfront"}]}),e}.apply(e,i),!(void 0!==r&&(t.exports=r))},function(t,e){t.exports='<span data-html="true" class="icon-info-circle optimal-RI-tooltip" data-toggle="tooltip" data-placement="bottom" data-original-title=\'\n    <div>\n    <p align="left">If the optimal RI number exceeds the number of RIs currently in use, it is recommended that you stay with the existing number and purchase additional RIs only when needed.</p>\n</div>\n\'></span>'},,function(t,e){t.exports='<span data-html="true" class="icon-info-circle RI-basis-tooltip" data-toggle="tooltip" data-placement="bottom" data-original-title=\'\n    <div>\n        <p align="left">\n            <strong>History</strong> insight helps you to understand your payment for the <strong>past</strong> year, and our recommended instance package and optimized payment in the same period.\n        </p>\n        <p style="line-height: 20%"></p>\n        <p align="left">\n            <strong>Prediction</strong> insight helps you to understand your payment for the <strong>following</strong> year, and our recommended instance package and optimized payment in the same period.\n        </p>\n    </div>\n\'></span>'},,,,,,,,,,,,,function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(a[r]=!0)}for(i=0;i<e.length;i++){var o=e[i];"number"==typeof o[0]&&a[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),t.push(o))}},t}},function(t,e,n){function a(t,e){for(var n=0;n<t.length;n++){var a=t[n],i=h[a.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](a.parts[r]);for(;r<a.parts.length;r++)i.parts.push(c(a.parts[r],e))}else{for(var o=[],r=0;r<a.parts.length;r++)o.push(c(a.parts[r],e));h[a.id]={id:a.id,refs:1,parts:o}}}}function i(t){for(var e=[],n={},a=0;a<t.length;a++){var i=t[a],r=i[0],o=i[1],s=i[2],l=i[3],c={css:o,media:s,sourceMap:l};n[r]?n[r].parts.push(c):e.push(n[r]={id:r,parts:[c]})}return e}function r(t,e){var n=g(),a=y[y.length-1];if("top"===t.insertAt)a?a.nextSibling?n.insertBefore(e,a.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function o(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function s(t){var e=document.createElement("style");return e.type="text/css",r(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",r(t,e),e}function c(t,e){var n,a,i;if(e.singleton){var r=_++;n=m||(m=s(e)),a=d.bind(null,n,r,!1),i=d.bind(null,n,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),a=p.bind(null,n),i=function(){o(n),n.href&&URL.revokeObjectURL(n.href)}):(n=s(e),a=u.bind(null,n),i=function(){o(n)});return a(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;a(t=e)}else i()}}function d(t,e,n,a){var i=n?"":a.css;if(t.styleSheet)t.styleSheet.cssText=v(e,i);else{var r=document.createTextNode(i),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(r,o[e]):t.appendChild(r)}}function u(t,e){var n=e.css,a=e.media;if(a&&t.setAttribute("media",a),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function p(t,e){var n=e.css,a=e.sourceMap;a&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var i=new Blob([n],{type:"text/css"}),r=t.href;t.href=URL.createObjectURL(i),r&&URL.revokeObjectURL(r)}var h={},f=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},A=f(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),g=f(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,_=0,y=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=A()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=i(t);return a(n,e),function(t){for(var r=[],o=0;o<n.length;o++){var s=n[o],l=h[s.id];l.refs--,r.push(l)}if(t){var c=i(t);a(c,e)}for(var o=0;o<r.length;o++){var l=r[o];if(0===l.refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete h[l.id]}}}};var v=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},,,,function(t,e){t.exports=r},,,function(t,e,n){var a,i;a=[n(4),n(7),n(33)],i=function(t,e,n){"use strict";var a=e.utils,i=a.getPageInfo().app,r=1e4;return{search:function(e,a,o){a||(a={});var s,l=o?{tokens:!0}:null,c=$.Deferred(),d=new n($.extend({id:t.uniqueId("adhoc"),search:e,preview:!1,app:i,count:r,offset:0},a),l);return d.once("search:done",function(){s=d.data(a.data||"results",{output_mode:"json",count:r}),s.once("data",function(){c.resolve(s.data().results)}),s.once("error",c.reject),s.fetch()}),d.once("search:error search:fail search:cancelled",c.reject),c.always(function(){s&&s.destroy(),d.cancel()}).promise()}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=o},function(t,e,n){var a,i;a=[n(4),n(7),n(35),n(2),n(37)],i=function(t,e,n,a,i){"use strict";var r=e.utils,o=e.BaseModel,s=e.BaseView,l=e.splunkd_utils,c=r.getPageInfo().app,d=r.getPageInfo().page,u=s.extend({initialize:function(){s.prototype.initialize.apply(this,arguments),this.model=new o({messages:{}}),this.listenTo(this.model,"change",this.render)},events:{"click .hide-messages":"hideMessages"},setMessage:function(e,n,a,i){if("string"==typeof e&&e.length>0){var r=t.clone(this.model.get("messages"));r[e]={body:n,helpLink:a,type:i||"warning"},this.model.set("messages",r)}},unsetMessage:function(e){if("string"==typeof e&&e.length>0){var n=t.clone(this.model.get("messages"));delete n[e],this.model.set("messages",n)}else if("[object Array]"===Object.prototype.toString.call(e)){for(var a=t.clone(this.model.get("messages")),i=0;i<e.length;i++){var r=e[i];delete a[r]}this.model.set("messages",a)}},clearAllMessages:function(e){var n=t.clone(this.model.get("messages"));Object.keys(n).forEach(function(t){n[t].type===e&&delete n[t]}),this.model.set("messages",n)},render:function(){var e=this.model.get("messages"),a=!1;if(Object.keys(e).length>0){var i="";for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];a|="warning"===o.type;var s="";o.helpLink&&(s=n.buildLinkNode(o.helpLink));var l="warning"===o.type?"alert-warning":"info"===o.type?"alert-info":"alert-error",c=t.template(this.template,{warningClassName:l,messageBody:o.body,helpLink:s});i+=c}""!==i&&a&&(i+='<a class="hide-messages">Hide Messages</a>'),this.$el.html(i)}else this.$el.html("");return this},hideMessages:function(){var t=this,e=l.fullpath("saas-aws/splunk_app_aws_warning_message",{app:c,sharing:"app"});$.ajax({url:e+"/"+d+"?output_mode=json",type:"delete",success:function(){t.clearAllMessages("warning")}})},template:'\t            <div class="sourcetype-checker alert <%=warningClassName %>">\t                <i class="icon-alert"></i><%= messageBody %></span> \t                <%= helpLink %> \t            </div> \t        '}),p=$(".dashboard-body .fieldset:eq(0)"),h=$('<div id="message-view"></div>');h.insertAfter(p);var f=new u({el:h});return f}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(36)],i=function(t,e){var n="splunk_app_aws",a="6.0.3",i=encodeURIComponent("["+n+":"+a+"]");return{buildLinkNode:function(t,n){return n=n||e.gettext("Learn more"),"<a class='external' target='_blank' href='/help?location="+i+t+"'>"+n+"</a>"}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){"use strict";function n(){return o.apply(void 0,arguments)}function a(){return o.apply(void 0,arguments)}function i(t){o=t}function r(){i("undefined"!=typeof window&&window.gettext||function(t){return t})}Object.defineProperty(e,"__esModule",{value:!0}),e.gettext=n,e._=a,e.setSharedTranslator=i,e.resetSharedTranslator=r;var o;r()},function(t,e,n){var a;a=function(){return{AWS_RECOMMENDATION_DEPENDENCY:"aws.recommendation.dependency",AWS_DASHBOARD_SOURCETYPECHECKER:"aws.dashboard.sourcetypechecker",AWS_BILLING_TAGS:"aws.billing.tags",AWS_RECOMMENDATION_SECURITYGROUP:"aws.recommendation.securitygroup",AWS_RECOMMENDATION_ELB:"aws.recommendation.elb",AWS_RECOMMENDATION_EC2:"aws.recommendation.ec2",AWS_DASHBOARD_ACCOUNTNAME:"aws.dashboard.accountname",AWS_DASHBOARD_BILLINGDATAMODEL:"aws.dashboard.billingdatamodel",AWS_CUSTOM_INDEX:"aws.dashboard.customindex",AWS_DATA_FORWARDING:"aws.dashboard.dataforwarding",AWS_RI_PLANNER:"aws.dashboard.riplanner",AWS_RECOMMENDATION_EBS:"aws.dashboard.ebs",AWS_ANOMALY_DETECTION:"aws.dashboard.anomalydetection",AWS_BEFORE_UPGRADE:"beforeUpgrade",AWS_AFTER_UPGRADE:"afterUpgrade"}}.call(e,n,e,t),!(void 0!==a&&(t.exports=a))},function(t,e,n){var a,i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};a=[n(2),n(39),n(7)],i=function(t,e,n){"use strict";var a=(n.utils,n.splunkd_utils,/\$PREFIX\$/g),i="detailed_billing",o="instance_hour",s="detailed_billing_cur",l="instance_hour_cur",c='timechart sum(count) as "Instance Hours" span=1d',d='timechart sum(count) as "Instance Hours" span=1d',u='timechart span=1d sum(cost) as "Cost"',p={USD:"$",CNY:"¥",JPY:"¥",EUR:"€"},h=t.Components.getInstance("default"),f=function(t,n,a){if(h.get("disableLocalToken"))return null;h.on("change:"+n,function(e,n){void 0!==("undefined"==typeof n?"undefined":r(n))&&void 0!==n||(n="*"),localStorage.setItem(t,n)});var i=localStorage.getItem(t)||"*";h.set(t,i),new e(["$"+t+"$"],"$"+n+"$",a)};t.setFilter("currency2Symbol",function(t){if(t)return t in p?p[t]:""}),["countspl","costspl"].forEach(function(e){t.setFilter("groupby2"+e,function(t){var n="countspl"===e?c:u,a="countspl"===e?o:i;if(!(t&&t.length>0))return t;switch(t){case"none":return"by _time span=1d | "+n;case"reservation":return"by _time "+o+'.ReservedInstance span=1d | eval Reserved=if(\'instance_hour.ReservedInstance\'="Y", count, 0) | eval count=if(\'instance_hour.ReservedInstance\'="N", count, 0) | fields _time count Reserved | timechart sum(count) as "On-demand" sum(Reserved) as Reserved span=1d';default:return"by _time "+a+"."+t+" span=1d | eval "+a+"."+t+"=if('"+a+"."+t+'\'=="", "No Value", \''+a+"."+t+"') | "+n+" by "+a+"."+t}}),t.setFilter("curgroupby2"+e,function(t){var n="countspl"===e?d:u,a="countspl"===e?l:s;if(!(t&&t.length>0))return t;switch(t){case"none":return"by _time span=1d | "+n;case"reservation":return"by _time "+l+'.ReservedInstance span=1d | eval Reserved=if(\'instance_hour_cur.ReservedInstance\'="Y", count, 0) | eval count=if(\'instance_hour_cur.ReservedInstance\'="N", count, 0) | fields _time count Reserved | timechart sum(count) as "On-demand" sum(Reserved) as Reserved span=1d';default:return"by _time "+a+"."+t+" span=1d | eval "+a+"."+t+"=if('"+a+"."+t+'\'=="", "No Value", \''+a+"."+t+"') | "+n+" by "+a+"."+t}})}),t.setFilter("costbygroups",function(t){if(t&&t.length>0){var e=t.split("|"),n=e.map(function(t){return i+"."+t}).join(" "),a=e.map(function(t){return i+"."+t+" as "+t}).join(", ");return"by "+n+" | rename "+a}return t}),t.setFilter("curcostbygroups",function(t){if(t&&t.length>0){var e=t.split("|"),n=e.map(function(t){return s+"."+t}).join(" "),a=e.map(function(t){return s+"."+t+" as "+t}).join(", ");return"by "+n+" | rename "+a}return t});var A=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" OR ";return function(i){if(i&&i.length>0){var r=i.split(n).map(t).join(a);return e(r)}return i}};return t.setFilter("id2InstanceId",A(function(t){return'metric_dimensions="InstanceId=['+t+']"'},function(t){return"("+t+")"})),t.setFilter("id2VolumeId",A(function(t){return'metric_dimensions="VolumeId=['+t+']"'},function(t){return"("+t+")"})),t.setFilter("id2description",A(function(t){return'id="'+t+'"'},function(t){return"("+t+")"})),["tag2description","tag2config"].forEach(function(e){t.setFilter(e,A(function(t){return t.replace(a,"tags.")},function(t){return"|search "+t},"||"," AND "))}),t.setFilter("tag2notification",A(function(t){return t.replace(a,"configurationItem.tags.")},function(t){return"|search "+t},"||"," AND ")),t.setFilter("tag2billing",A(function(t){return t=t.replace(a,"user:"),'"'+t+'"'},function(t){return"|search "+t},"||"," AND ")),t.setFilter("tag2detailed_billing",A(function(t){return t=t.replace(a,"detailed_billing.")},function(t){return t},"||"," AND ")),t.setFilter("tag2detailed_billing_cur",A(function(t){return t=t.replace(a,"detailed_billing_cur.")},function(t){return t},"||"," AND ")),t.setFilter("tag2instance_hour",A(function(t){return t=t.replace(a,"instance_hour.")},function(t){return t},"||"," AND ")),t.setFilter("tag2instance_hour_cur",A(function(t){return t=t.replace(a,"instance_hour_cur.")},function(t){return t},"||"," AND ")),t.setFilter("tag2topology",function(t){if(t&&t.length>0){for(var e=t.split(" OR "),n='| fillnull value="" tags | search ',i=0;i<e.length;i++){var r=e[i].replace(a,""),o=r.split("="),s=o[0],l=o[1],c=!1,d=!1;if("NOT"===s.substr(0,3)?(d=!0,s=s.substr(4)):"*"===l[1]&&"*"===l[l.length-2]&&(c=!0),l=l.substring(1,l.length-1),c)l=l.substring(1,l.length-1),n+='tags="\\S*'+s+",\\S*"+l+'\\S*"';else if(d)n+='tags="^(?!.*'+s+',)"';else{var u=r.split("=");if(r.search("AND")==-1&&(n+='(tags="*'+u[0]+","+u[1].slice(1,u[1].length-1)+'*")'),r.search("AND")!=-1)for(var p=r.split(" AND "),h=0;h<p.length;h++){var f=p[h].split("=");n+='(tags="*'+f[0]+","+f[1].slice(1,f[1].length-1)+'*")',h!=p.length-1&&(n+=" AND ")}}i!=e.length-1&&(n+=" OR ")}return n}return t}),{createLocalStorageToken:f,resetTokenValue:function(t,e,n){h.on("change:"+t,function(){h.set(e,n)})}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=s},,,,,,,,,function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(49),n(50),n(51),n(61),n(62),n(64),n(65),n(66),n(38),n(52),n(68),n(39),n(59),n(32),n(54),n(69),n(72),n(76),n(53)],i=function(t,e,n,a,i,r,o,s,l,c,d,u,p,h,f,A,g,m,_){"use strict";var y=n.utils,v=n.splunkd_utils;g.search("|inputlookup instance_type",{earliest_time:"-1d"}).then(function(t){0==t.length&&g.search("|checkinstancetype",{earliest_time:"-1d"}).then(function(t){t.length>0&&location.reload()},function(t){console.log(t)})},function(t){console.log(t)}),u.createLocalStorageToken("localAccountId","form.accountId",function(t){return t?t.split(","):f.NO_CHANGE}),u.createLocalStorageToken("localRegions","form.region",function(t){return t?t.split(","):f.NO_CHANGE});var C=e.Components.get("default");h.setRestrictedSearchTermToken();var b=y.getPageInfo().page,E=y.getPageInfo().app,I=e.createService(),x=I.configurations({owner:"nobody",app:"splunk_app_aws"});x.fetch(function(t,e){var n=e.item("app");n.fetch(function(t,e){for(var n=e.properties(),a=0;a<n.entry.length;a++){var i=n.entry[a].name;if("upgrade"==i){var r=n.entry[a].content.status;if("0"==r){var o=new _;o.render_info_view(),o.showUpgradeInfo()}}}})}),a.showWarning();var w=$("#awstags");if(w.length>0){new o({el:w}).render();var R=C.get("tags");R||C.set("tags","")}Object.keys(e.Components.attributes).forEach(function(n){var a=e.Components.get(n);if("undefined"!=typeof a.getVisualizationType){var i=a.getVisualizationType();"table"===i||"statistics"===i?(a.getVisualization(function(t){t.table.addCellRenderer(new s),t.table.render()}),a.getVisualization(function(t){t.table.addCellRenderer(new l),t.table.render()}),a.getVisualization(function(t){t.table.addCellRenderer(new c),t.table.render()})):"single"!==i&&"visualizations:singlevalue"!==i||a.getVisualization(function(e){var n=$("<div></div>").insertAfter(e.$el);new d($.extend(e.settings.toJSON(),{el:n,id:t.uniqueId("single")}))})}}),A.loadContext().done(function(){var t=v.fullpath("saas-aws/splunk_app_aws_warning_message",{app:E,sharing:"app"}),e=function(){new r,i.checkCustomIndex(A.contextData.IS_AWS_ADMIN)};$.get(t+"?output_mode=json").done(function(t){var n=t.entry[0].content.pages;n.indexOf(b)===-1&&e()}).fail(function(){e()})});var O=new m;O.fetch({data:{count:-1}}).done(function(){var t=e.Components.getInstance("submitted");t.set("recommendationEnabled",!0)})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(34),n(37)],i=function(t,e,n,a,i){var r=n.utils,o={iam:["ACCELERATION_REPORT"],key_pairs:["ACCELERATION_REPORT"],network_acls:["ACCELERATION_REPORT"],security_groups:["ACCELERATION_REPORT"],security_overview:["ACCELERATION_REPORT"],user_activity:["ACCELERATION_REPORT"],vpcs:["ACCELERATION_REPORT"],RI_planner:["RI_PLANNER_PRICE_INFO"],RI_planner_cur:["RI_PLANNER_PRICE_INFO"]},s={ACCELERATION_REPORT:{source:"report acceleration hint",body:"It may take a long time to return search results in the current panel due to pending report acceleration.",helpLink:null},RI_PLANNER_PRICE_INFO:{source:"riPrice",body:'To keep the prices of EC2 instances up-to-date, use this search command: "| rirecommendation info".',helpLink:null}},l=r.getPageInfo().page;return{showWarning:function(){t.isUndefined(o[l])||o[l].forEach(function(t){var e=s[t];a.setMessage(e.source,e.body,e.helpLink,e.type||"info")})}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(33),n(34),n(37)],i=function(t,e,n,a,i,r){var o=n.utils,s={topology:["aws_topology_history","aws_topology_daily_snapshot","aws_topology_monthly_snapshot","aws_topology_playback"],vpc_flow_logs_security:["aws_vpc_flow_logs"],vpc_flow_logs_traffic:["aws_vpc_flow_logs"],insights_overview:["aws_anomaly_detection"],billing_anomaly_detection_insights:["aws_anomaly_detection"],security_anomaly_detection_insights:["aws_anomaly_detection"]},l=e.createService({owner:"nobody",app:o.getCurrentApp()}),c=o.getPageInfo().page;return{checkCustomIndex:function(e){var n=this;t.isUndefined(s[c])||l.request("server/info","GET").done(function(t){var a=JSON.parse(t).entry[0].content,i=a.server_roles,r=a.isForwarding,o=a.host;i.indexOf("search_head")===-1?n._checkOnSingleInstance():r?n._checkOnDistributedEnv(e,o):n._showForwardingWarning()})},_checkOnSingleInstance:function(){var e=this,n=s[c];l.request("data/indexes","GET").done(function(a){var i=t.pluck(JSON.parse(a).entry,"name"),r=t.difference(n,i);r.length>0&&e._showIndexWarning(r)})},_checkOnDistributedEnv:function(e,n){var i=this,r=s[c],o=new a({id:t.uniqueId(),earliest_time:"-6h",latest_time:"now",search:"index="+r[0]+" | head 1"});o.on("search:done",function(o){if(0===o.content.resultCount)if(e){var s=new a({id:t.uniqueId(),earliest_time:"-1h@h",latest_time:"now",search:'index=_internal source=*splunkd.log log_level=WARN component=IndexerService message="*'+n+'*" message="Received event for unconfigured/disabled/deleted index='+r[0]+'*"'});s.on("search:done",function(t){t.content.resultCount>0&&i._showIndexWarning(r)})}else i._showIndexWarning(r)})},_showIndexWarning:function(t){var e="Some panels may not be displayed correctly because you do not have created the following indexes: "+t.join(", ")+", or, data of these indexes have not been generated.";i.setMessage("customIndexChecker",e,r.AWS_CUSTOM_INDEX)},_showForwardingWarning:function(){var t="Some panels may not be displayed correctly. Configure this search head to forward data directly to the indexer layer.";i.setMessage("customIndexChecker",t,r.AWS_DATA_FORWARDING)}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(7),n(52),n(34),n(54),n(58),n(32),n(59),n(37)],i=function(t,e,n,a,i,r,o,s,l){"use strict";var c=e.BaseModel,d=e.BaseView,u=d.extend({initialize:function(){var e=this;d.prototype.initialize.apply(this,arguments),this.model=new c({inputs:[],recommendation:null}),this.instance_type="",o.search("|inputlookup instance_type",{earliest_time:"-1d"}).then(function(t){0!=t.length&&"on-prem"==t[0].value&&(e.instance_type="on-prem")},function(t){console.log("Received an error during verification of Instance type"+t)}),this.cachedSourcetypes=null,this.cachedRecommendation=null,this.messageView=a,this._getInputsOnce=t.once(this._getInputs),
this._getRecommendationOnce=t.once(this._getRecommendation),this.listenTo(n,"change:sourcetype",function(t){e._getInputsOnce(),e._verifyInputs(e.cachedSourcetypes,t)}),this.listenTo(n,"change:recommendation",function(t){t&&(e._getRecommendationOnce(),e._verifyRecommendation(e.cachedRecommendation))}),this.listenTo(this.model,"change",this.render)},render:function(){var t=this.model.get("inputs"),e=this.model.get("recommendation");if(t&&t.length>0){var n="Some panels may not be displayed correctly because the following inputs have not been configured: "+t.join(", ")+'.<br/>Or, the saved search "Addon Metadata - Summarize AWS Inputs" is not enabled on Add-on instance.';this.messageView.setMessage("sourcetypeChecker",n,l.AWS_DASHBOARD_SOURCETYPECHECKER)}if(e){var a="Some panels in this dashboard may not be displayed correctly. ";e.indexOf("ML lib does not exist")>=0&&"on-prem"==this.instance_type?(a+='The App "Python for Scientific Computing" is not installed or incorrectly configured.',this.messageView.setMessage("recommendation",a,l.AWS_RECOMMENDATION_DEPENDENCY)):e.indexOf("AWS Admin Validation Failed")>=0?(a+="Only AWS admin can visit the insights.",this.messageView.setMessage("recommendation",a,l.AWS_RECOMMENDATION_DEPENDENCY)):e.indexOf("Not supported in Splunk Light")>=0&&(a+="It is not supported in Splunk Light.",this.messageView.setMessage("recommendation",a,l.AWS_RECOMMENDATION_DEPENDENCY))}return this},_getInputs:function(){var e=this;o.search("`aws-input-summary` | dedup input_sourcetype | fields input_sourcetype",{earliest_time:"-1d"}).then(function(n){n&&n.length>0?e.cachedSourcetypes=t.pluck(n,"input_sourcetype").reduce(function(t,e){return t[r.findInputBySourcetype(e)]=!0,t},{}):e.cachedSourcetypes=[]})},_getRecommendation:function(){var t=this,e=new i;e.fetch({data:{count:-1}}).catch(function(e){t.cachedRecommendation=e})},_verifyInputs:function(t,e){if(t){var n=e.map(function(e){return e=r.findInputBySourcetype(e),e in t?null:e}).filter(function(t){return!!t});this.model.set("inputs",n)}},_verifyRecommendation:function(t){t&&t.responseText&&this.model.set("recommendation",t.responseText)}});return u}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(5),n(2),n(33),n(53)],i=function(t,e,n,a){"use strict";function i(){return Object.keys(n.Components.attributes).map(function(t){var e=n.Components.get(t),i=null;return e instanceof a?i=e:e.manager&&e.manager instanceof a&&(i=e.manager),i}).filter(function(t){return null!==t})}function r(t){return t.indexOf("services/saas-aws/splunk_app_aws_recommendation")>-1}function o(){var t=i(),e=!1,n=t.map(function(t){return t.has("data")?t.get("data").eventSearch+t.get("data").reportSearch:null}).filter(function(t){return!!t}).map(function(t){!e&&r(t)&&(e=!0);var n=[],a=t.match(l);a&&(n=a.map(function(t){var e=l.exec(t);return e&&e.length>1?e[1]:null}).filter(function(t){return null!==t}));for(var i in s){var o=new RegExp("\\b"+i+"\\b","g");o.test(t)&&n.push(s[i])}return n}).reduce(function(t,e){return e.forEach(function(e){t[e]=!0}),t},{});e&&d.trigger("change:recommendation",!0),d.trigger("change:sourcetype",Object.keys(n))}var s={aws_topology_daily_snapshot:"aws:config","services/saas-aws/splunk_app_aws_recommendation":"aws:cloudwatch","datamodel=Detailed_Billing":"aws:billing","datamodel=Instance_Hour":"aws:billing","datamodel=Detailed_Billing_CUR":"aws:billing:cur","datamodel=Instance_Hour_CUR":"aws:billing:cur","datamodel S3_Access_Log":"aws:s3:accesslogs","datamodel CloudFront_Access_Log":"aws:cloudfront:accesslogs"},l=/sourcetype\s*=[\s'"]*(aws:.+?)[\s'"]{1}/g,c=4e3,d=t.extend(e.Events);return setInterval(o,c),d}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=l},function(t,e,n){var a,i;a=[n(55),n(56)],i=function(t,e){return t.extend({url:"saas-aws/splunk_app_aws_recommendation",model:e,initialize:function(){t.prototype.initialize.apply(this,arguments)}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(7)],i=function(t){var e=t.SplunkDsBaseCollection;return e.extend({fetch:function(){var t=this,n=e.prototype.fetch.apply(this,arguments);return n.done(function(){t._fetched=!0}),n},isFetched:function(){return this._fetched===!0}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(57)],i=function(t,e){return e.extend({url:"saas-aws/splunk_app_aws_recommendation",urlRoot:"saas-aws/splunk_app_aws_recommendation",initialize:function(){e.prototype.initialize.apply(this,arguments)},getAttributeNames:function(){return["status","action","resourceId"]},parse:function(t){return t.entry[0].content}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(5),n(7)],i=function(t,e,n){var a=n.SplunkDBase,i=n.splunkd_utils,r=function(e,n){var a=t.isFunction(e.url)?e.url():e.url;e.id&&(a=e.id);var r={};return n.data&&(r=$.extend(r,{app:n.data.app||void 0,owner:n.data.owner||void 0,sharing:n.data.sharing||void 0})),a=i.fullpath(a,r),a+="?output_mode="+encodeURIComponent("json"),n.data&&n.data.target&&(a+="&target="+encodeURIComponent(n.data.target)),n.data&&n.data.aws_service&&(a+="&aws_service="+encodeURIComponent(n.data.aws_service)),a},o=function(t){delete t.data.app,delete t.data.owner,delete t.data.sharing,delete t.data.output_mode,delete t.data.target,delete t.data.aws_service,delete t.data.count},s=function(t,n){var a,s=$.Deferred(),l={data:{}};return l.url=r(t,n),l.processData=!0,$.extend(!0,l.data,t.includeListAttributes()),$.extend(!0,l,n),o(l),l.data=i.normalizeValuesForPOST(l.data),a=e.sync.call(null,"create",t,l),a.done(function(){s.resolve.apply(s,arguments)}),a.fail(function(){s.reject.apply(s,arguments)}),s.promise()},l=function(t,n){var a,s=$.Deferred(),l={data:{}};l.url=r(t,n),l.processData=!0;var c=$.extend(!0,{},n);return $.extend(!0,l.data,t.includeListAttributes(c)),$.extend(!0,l,n),o(l),l.processData=!0,l.type="POST",l.data=i.normalizeValuesForPOST(l.data),a=e.sync.call(null,"update",t,l),a.done(function(){s.resolve.apply(s,arguments)}),a.fail(function(){s.reject.apply(s,arguments)}),s.promise()},c=function(t,n){var a,s=$.Deferred(),l={data:{}};l.url=r(t,n),$.extend(!0,l.data,n.attrs&&t.includeListPassedInAttributes(n.attrs)||{}),delete n.attrs,$.extend(!0,l,n),o(l),l.processData=!0,l.type="POST",l.url=url,l.data=i.normalizeValuesForPOST(l.data),a=e.sync.call(null,"update",t,l),a.done(function(){s.resolve.apply(s,arguments)}),a.fail(function(){s.reject.apply(s,arguments)})},d=function(t,n){var a,i=$.Deferred(),s={data:{}};return s.url=r(t,n),$.extend(!0,s,n),o(s),s.processData=!0,a=e.sync.call(this,"delete",t,s),a.done(function(){i.resolve.apply(i,arguments)}),a.fail(function(){i.reject.apply(i,arguments)}),i.promise()};return a.extend({initialize:function(){a.prototype.initialize.apply(this,arguments)},getAttributeNames:function(){return[]},sync:function(t,e,n){switch(t){case"create":return s.call(this,e,n);case"update":return l.call(this,e,n);case"patch":return c.call(this,e,n);case"delete":return d.call(this,e,n);default:return a.prototype.sync.apply(this,arguments)}},includeListAttributes:function(e){var n=this.getAttributeNames(),a=this.splunkDWhiteList.get("wildcard")||[],i=this.entry.content.filterByKeys(n,{allowEmpty:!0},e);return t.extend(i,this.entry.content.filterByWildcards(a,{allowEmpty:!0},e))},fetch:function(){var t=this,e=a.prototype.fetch.apply(this,arguments);return e.done(function(){t._fetched=!0}),e},isFetched:function(){return this._fetched===!0}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[],i=function(){"use strict";var t={"aws:cloudtrail":"CloudTrail","aws:config":"Config","aws:config:notification":"Config","aws:billing":"Billing (Legacy)","aws:billing:cur":"Billing (Cost and Usage Report)","aws:inspector":"Inspector","aws:config:rule":"Config Rule","aws:cloudwatch":"CloudWatch","aws:cloudfront:accesslogs":"CloudFront Access Logs","aws:elb:accesslogs":"ELB Access Logs","aws:s3:accesslogs":"S3 Access Logs","aws:description":"Description","aws:cloudwatchlogs:vpcflow":"VPC Flow Logs"};return{findInputBySourcetype:function(e){return t[e]}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(60)],i=function(t,e){var n={APP:"splunk_app_aws",OWNER:"nobody",ROLES:[],CAPABILITIES:[],IS_ADMIN:!1,IS_AWS_ADMIN:!1},a={config:"AWS Config","config-rule":"Config Rules",cloudwatch:"CloudWatch",cloudtrail:"CloudTrail",billing:"Billing",s3:"S3","cloudwatch-logs":"CloudWatch Logs",kinesis:"Kinesis",inspector:"Inspector",description:"Metadata"},i=$.Deferred();return{contextData:n,loadContext:function(){var t=this;return e.getContext(function(e){t.contextData=$.extend({},n,{APP:e.app,OWNER:e.owner,ROLES:e.roles,CAPABILITIES:e.capabilities,SERVICE_READABLE_NAMES:a,IS_ADMIN:e.is_admin,IS_AWS_ADMIN:e.is_aws_admin}),i.resolve()}),i}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(29),n(4),n(7)],i=function(t,e,n){var a=n.utils,i=n.splunkd_utils,r=t.Deferred(),o=a.getPageInfo().app,s=i.fullpath("saas-aws/splunk_app_aws_current_context",{app:o,sharing:"app"});return t.get(s+"?output_mode=json").done(function(t){var e=t.entry[0].content.roles,n=t.entry[0].content.capabilities,a=t.entry[0].content.is_admin;is_aws_admin=t.entry[0].content.is_aws_admin,r.resolve({app:o,roles:e,capabilities:n,is_admin:a,is_aws_admin:is_aws_admin})}).fail(function(){r.reject()}),{getContext:function(t,e){r.done(t),r.fail(e)}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(29),n(4),n(2),n(7),n(58),n(32),n(52)],i=function(t,e,n,a,i,r,o){"use strict";function s(t,e){return{id:t,text:t,stage:e}}var l=a.BaseView,c="STAGE_KEY",d="STAGE_OPERATOR",u="STAGE_VALUE",p="STAGE_RELATION",h={Config:"| inputlookup tags_config append=t",Description:"| inputlookup tags_description append=t","Billing (Legacy)":"| `aws-billing-datamodel-tags`","Billing (Cost and Usage Report)":"| `aws-billing-datamodel-tags-cur`"},f="$PREFIX$",A=/(.*?)!?=(.*?)\s+(AND|and|OR|or)\s+/g,g=/(.*?)\s+(AND|and|OR|or)\s+/g,m=/(['"])?(.*?)\1(!?=)(.*)/,_=/(["']?)([^\1]*)(\1)(.*)/,y=n.Components.getInstance("default"),v=n.Components.getInstance("submitted"),C=[],b=null,E=["=","!="].map(function(t){return s(t,d)}),I=["AND","OR"].map(function(t){return s(t,p)}),x=l.extend({events:{"keydown input":"onKeydown","input input":"onInput","focus input":"onFocus","mouseleave .tag-autocomplete":"_hideAutocomplete","blur input":"_hideAutocomplete","click ul > li":"_onSelecting"},_loadingTemplate:e.template('<li class="tag-loading">\n                <span class="loading-img"></span>\n                <span style="font-weight: bold;">Loading</span>\n            </li>'),_onSelecting:function(e){var n=this._currentStatus,a=t(e.currentTarget).data("stage"),i=this.$("input").val();switch(a){case c:i=i.replace(new RegExp(n.key+"$"),t(e.currentTarget).text());break;case d:i+=t(e.currentTarget).text();break;case u:var r=i.lastIndexOf("=");i=i.substring(0,r+1),i+='"'+t(e.currentTarget).text()+'"';break;case p:i=i.replace(new RegExp(n.rel+"$")," "+t(e.currentTarget).text()+" ")}this.$("input").val(i).focus(),this.onInput(),a===c&&this.$(".tag-autocomplete").hide()},onKeydown:function(t){if(38===t.keyCode||40===t.keyCode){var e=this.$(".tag-autocomplete").height(),n=this.$(".tag-autocomplete").scrollTop();if(0===this.$(".tag-autocomplete > ul > li").length)return;var a=this.$(".tag-autocomplete > ul > li.active"),i=null;if(i=40===t.keyCode?0===a.length?this.$(".tag-autocomplete > ul > li").first():a.next():0===a.length?this.$(".tag-autocomplete > ul > li").last():a.prev(),a.removeClass("active"),0===i.length)return;i.addClass("active");var r=i.position().top,o=i.height(),s=r+o-e;r<0?this.$(".tag-autocomplete").scrollTop(n+r):s>0&&this.$(".tag-autocomplete").scrollTop(n+s+1),t.preventDefault()}else if(13===t.keyCode){var l=this.$(".tag-autocomplete > ul > li.active");if(0!==l.length&&this.$(".tag-autocomplete").is(":visible"))l.trigger("click");else{var c=this.$("input").val(),d="";if(""!==c.trim()){for(var u=void 0;null!==(u=g.exec(c));){var p=this._processTerm(u[1]);d+=p+" "+u[2]+" "}d+=this._processTerm(c.replace(g,""))}y.set("tags",d),y&&v&&v.set(y.toJSON())}}},_processTerm:function(t){var e=m.exec(t);return 5===e.length?(e[2]=f+e[2],e[1]||(e[1]=""),""+e[1]+e[2]+e[1]+e[3]+e[4]):""},onInput:function(){var t=this.$("input").val().replace(A,""),e=this._detectStatus(t);this._handleStatus(e),this._currentStatus=e},onFocus:function(){this._cachedKeys?this.onInput():this._fetchKeys(status.key)},_hideAutocomplete:function(){var t=this;e.delay(function(){t.$("input").is(":focus")||t.$(".tag-autocomplete").hide()},200)},_handleStatus:function(t){var e=[];switch(t.stage){case c:this._cachedKeys?(e=this._filterTokens(this._cachedKeys,t.key),this._showAutoComplete(e)):this._fetchKeys(t.key);break;case d:e=E,this._showAutoComplete(e);break;case u:this._cachedKey!==t.key?this._fetchValues(t.key,t.value):(e=this._filterTokens(this._cachedValues,t.value),this._showAutoComplete(e));break;case p:e=I,this._showAutoComplete(e)}},_showAutoComplete:function(t){var n=t.map(function(t){var n=e.escape(t.text),a=e.escape(t.stage);return'<li data-stage="'+a+'">'+n+"</li>"}).join("");this.$(".tag-autocomplete > ul").html(n),this.$(".tag-autocomplete").show()},_showLoading:function(){this.$(".tag-autocomplete > ul").html(this._loadingTemplate()),this.$(".tag-autocomplete").show()},_fetchKeys:function(t){var e=this;this._showLoading(),r.search(b+" | stats count by key | fields - count").then(function(n){e._cachedKeys=n.map(function(t){return s(t.key,c)}),0===e._cachedKeys.length&&(e._cachedKeys=null);var a=e._filterTokens(e._cachedKeys,t);e._showAutoComplete(a)},function(t){console.log(t)})},_fetchValues:function(t,e){var n=this,a="",i="`aws-billing-cur-tag-value("+t+")`",o="`aws-billing-tag-value("+t+")`";a=b.indexOf("`aws-billing-datamodel-tags`")>-1?b+" | search key=CASE("+t+") | "+o+" | search value=* | fields value":b.indexOf("`aws-billing-datamodel-tags-cur`")>-1?b+" | search key=CASE("+t+") | "+i+" | search value=* | fields value":b+" | search key=CASE("+t+") | dedup value | fields value",this._showLoading(),this._cachedKey=t,r.search(a).then(function(t){n._cachedValues=t.map(function(t){return s(t.value,u)});var a=n._filterTokens(n._cachedValues,e);n._showAutoComplete(a)},function(t){console.log(t)})},_filterTokens:function(t,e){if(!t)return[];var n=t;return e&&(n=t.filter(function(t){return t.text.toUpperCase().indexOf(e.toUpperCase())>-1&&t.text!==e})),n},_detectStatus:function(t){var e={key:null,op:null,value:null,rel:null,stage:null};t.indexOf("!=")>-1?e.op="!=":t.indexOf("=")>-1&&(e.op="=");var n=t.split(e.op);if(e.key=n[0],n.length>1){var a=n[1],i=a.match(_);i&&5===i.length?(e.value=i[2],e.rel=i[4]):e.value=a}return e.stage=this._getStage(e),e},_getStage:function(t){return t.rel?p:t.value||t.op?u:c},initialize:function(){var t=this;this._reset(),this.onInput=e.debounce(this.onInput,50),this.listenTo(o,"change:sourcetype",function(n){var a=n.map(function(t){return i.findInputBySourcetype(t)}).filter(function(t){return!!t});e.isEqual(a,C)||(C=a,b=t._generateSPL(y.get("form.accountId")||"*",a),t.$el.find("input").attr("placeholder","key=value AND|OR key2=value2").prop("disabled",!1))}),y.on("change:accountId",this._reset.bind(this))},render:function(){var t=y.get("tags");t=t?'value="'+t.replace(/\$PREFIX\$/g,"").replace(/\"/g,"&quot;")+'"':"",this.$el.html('\n                <label>Tags</label>\n                <input type="text" placeholder="loading..." disabled '+t+' />\n                <div class="tag-autocomplete"><ul></ul></div>\n            '),this.$el.show()},_reset:function(){this._cachedKeys=null,this._cachedKey=null,this._cachedValues=null,this._currentStage=c,this._currentStatus=null},_generateSPL:function(t,e){var n=e.filter(function(t){return t in h}).map(function(e){var n=h[e];return["Description","Config"].indexOf(e)>-1&&(n+="*"===t?"":" where aws_account_id="+t),n}).sort(function(t,e){return t.indexOf("`aws-billing-datamodel-tags`")>-1?-1:t.indexOf("`aws-billing-datamodel-tags-cur`")>-1?-1:e.indexOf("`aws-billing-datamodel-tags`")>-1?1:e.indexOf("`aws-billing-datamodel-tags-cur`")>-1?1:0}).join(" ");return n}});return x}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(63),n(53)],i=function(t,e,n){"use strict";var a=["Percentage"],i=n.BaseCellRenderer.extend({initialize:function(t){this.fields=a,n.BaseCellRenderer.prototype.initialize.apply(this,arguments)},canRender:function(t){return this.fields.indexOf(t.field)>-1},render:function(e,n){var a=Math.min(Math.max(parseFloat(n.value),0),100);return isNaN(a)?void e.html("N/A"):void e.addClass("data-bar-cell").html(t.template(this.template,{percent:a,cellValue:String(n.value)}))},template:'\t            <div class="data-bar-wrapper">\t                <div class="data-bar" style="width:<%- percent %>%">\t                    <div class="data-bar-custom-text">\t                        <span class="data-bar-badge"><%- cellValue %></span>\t                    </div>\t                </div>\t            </div>\t        '});return i}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=c},function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(63),n(32),n(29),n(53)],i=function(t,e,n,a,i){"use strict";var r=(n.utils,["Event Name"]),o=a.BaseCellRenderer.extend({initialize:function(e){var n=this;this.valueMap=null,this.search=i.search("| inputlookup all_eventName").then(function(e){var a={};t(e).each(function(t){a[t.eventName]=t.highlight}),n.valueMap=a}),this.fields=r,a.BaseCellRenderer.prototype.initialize.apply(this,arguments)},canRender:function(t){return this.fields.indexOf(t.field)>-1},render:function(t,e){var n=this;return $.when(this.search).done(function(){t.text(e.value);var a=n.valueMap[e.value];null!==a&&t.addClass("range-"+a)}),this}});return o}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(63),n(53)],i=function(t,e,n){var a={CREATE:["range-cell","range-low"],UPDATE:["range-cell","range-elevated"],DELETE:["range-cell","range-severe"],Unauthorized:["range-cell","range-unauth","numeric"],Authorized:["range-cell","range-auth","numeric"],"Error Code":["range-cell","range-err"]},i={Direction:{ingress:["range-cell","inbound"],egress:["range-cell","outbound"]},"Instance State":{"in service":["range-cell","range-low"],"out of service":["range-cell","range-severe"],healthy:["range-cell","range-low"],unused:["range-cell","range-severe"],unhealthy:["range-cell","range-severe"],draining:["range-cell","range-severe"]}},r=Object.keys(a).concat(Object.keys(i)),o=n.BaseCellRenderer.extend({canRender:function(t){return r.indexOf(t.field)>-1},render:function(t,e){var n=e.field,r=e.value;if(n in a&&a[n].forEach(function(e){t.addClass(e)}),n in i){var o=i[n];r in o&&o[r].forEach(function(e){t.addClass(e)})}t.text(r)}});return o}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(67),n(53)],i=function(t,e,n){"use strict";var a="_total_field",i="_total_name",r="_total_prefix",o=n.extend({outputMode:"json",returnCount:2,options:{},displayMessage:function(){},createView:function(){return!0},updateView:function(e,n){var o=0,s="events",l="out of",c="",n=n[0];this.$el.empty(),t.isUndefined(n[a])?c="display: none":o=n[a],t.isUndefined(n[i])||(s=n[i]),t.isUndefined(n[r])||(l=n[r]);var d=t.template(this.template,{prefix:l,total:o,name:s,hide:c});this.$el.html(d)},template:'\t            <div class="single-total" style="<%- hide %>" title="Total value: <%- total %>">\t                <%- prefix %> <b><%- total %></b> <%- name %>\t            </div>\t        '});return o}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=d},function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(53)],i=function(t,e,n){var a=n.utils,i=n.splunkd_utils,r=a.getPageInfo().app,o=a.getPageInfo().page,s={cloudfront_access_logs:{prefix:"CloudFront_Access_Log.",field:"account_id",token:"cloudfront_datamodel_restrictions"},s3_access_logs:{prefix:"S3_Access_Log.",field:"account_id",token:"s3_datamodel_restrictions"}},l=e.Components.getInstance("submitted");return{setRestrictedSearchTermToken:function(){var t=s[o];if(t){var e=i.fullpath("saas-aws/splunk_app_aws_search_restrictions",{app:r,sharing:"app"});$.ajax({url:e+"?output_mode=json&field="+t.field+"&prefix="+t.prefix,type:"get",success:function(e){var n=e.entry[0].content.search_restrictions;l.set(t.token,n)}})}}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(70),n(35),n(37),n(71)],i=function(t,e,n,a,i,r){var o=n.Modal,s='<a href="#" class="btn cancel-job pull-left">Cancel</a>',l='<a href="#" class="btn btn-primary ack-info pull-left">Acknowledge</a>',c='<a href="#" class="btn btn-primary modal-btn-primary pull-right">OK</a>',d='<a href="#" class="btn create-job pull-right">Create</a>',u=["create-alert","edit-alert","delete-alert","create-job","edit-job","delete-job","change-job-mode"];return o.extend({initialize:function(t){o.prototype.initialize.apply(this,arguments)},events:$.extend({},o.prototype.events,{"click .cancel-job":function(t){t.preventDefault(),this.hide()},"click .ack-info":function(t){t.preventDefault();var n=e.createService(),a=n.configurations({owner:"nobody",app:"splunk_app_aws"});a.fetch(function(t,e){var n=e.item("app");n.fetch(function(t,n){for(var a=n.properties(),i=0;i<a.entry.length;i++){var r=a.entry[i].name;"upgrade"==r&&e.post("app/upgrade",{status:1})}})}),this.hide()},"click a.create-alert":function(t){t.preventDefault(),this.hide(),this.trigger("createAlert",this.name)},"click a.edit-alert":function(t){t.preventDefault(),this.hide(),this.trigger("editAlert")},"click a.delete-alert":function(t){t.preventDefault(),this.hide(),this.trigger("deleteAlert",this.id,this.alert,!0)},"click a.delete-job":function(t){t.preventDefault(),this.hide(),this.trigger("deleteJob",this.id,this.alert)},"click a.edit-job":function(t){t.preventDefault(),this.hide(),this.trigger("editJob",this.name)},"click .create-job":function(t){t.preventDefault(),this.hide(),this.trigger("createJob")},"click .change-job-mode":function(t){t.preventDefault(),this.hide(),this.trigger("changeJobMode",this.id,this.mode)}}),render:function(){return this.$el.html(o.TEMPLATE),this.$(o.FOOTER_SELECTOR).append(s),this.$(o.FOOTER_SELECTOR).append(c),this.$(o.FOOTER_SELECTOR).append(d),this.$(".create-job").hide(),this},render_info_view:function(){return this.$el.html(o.TEMPLATE),this.$(o.FOOTER_SELECTOR).append(l).css("display","block"),this.$(".create-job").hide(),this},showFail:function(t,e){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html("Fail to "+e),this.$(".btn-primary").html("OK"),this.$(o.BODY_SELECTOR).html("Operations on "+t+" has been failed. Please try again."),this.show()},showAlertLoadFail:function(t){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html("Fail to load"),this.$(".btn-primary").html("Create"),this.$(".btn-primary").addClass("create-alert"),this.$(o.BODY_SELECTOR).html('Fail to load "'+t+"\" associate alert.<br>This is because alert's permission or accident deletion.\t            <br>Do you want to create another alert associate with current job ?"),this.name=t,this.show()},showJobSaveSuccess:function(t,e){this._clean();var n=(t&r.EDIT_MODE)>0?"updated":"saved",a=(e&r.EDIT_MODE)>0?"Edit Alert":"Create Alert";this.$(o.HEADER_TITLE_SELECTOR).html("Job has been "+n),this.$(".btn-primary").html(a);var i="";(e&r.EDIT_MODE)>0?(this.$(".btn-primary").addClass("edit-alert"),i+="You can continue to edit the binding alert.<br>"):(this.$(".btn-primary").addClass("create-alert"),i+="You can continue to create an alert associated with the job.<br>"),i+='If you want to receive customized email, please select action "Send email".',this.$(o.BODY_SELECTOR).html(i),this.show()},showJobDeleteConfirm:function(e,n,a){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html("Delete job"),this.$(".btn-primary").html("Delete"),this.$(".btn-primary").addClass("delete-job");var i="Are you sure you want to delete job ("+n+")";t.isEmpty(a)||(i+=" and corresponding alert ("+a.entry.get("name")+")"),i+=" ?",this.$(o.BODY_SELECTOR).html(i),this.id=e,this.alert=a,this.show()},showAlertDeleteConfirm:function(e,n,a){this._clean(),t.isEmpty(a)?this.showAlertLoadFail(n):(this.$(o.HEADER_TITLE_SELECTOR).html("Delete alert"),this.$(".btn-primary").html("Delete"),this.$(".btn-primary").addClass("delete-alert"),this.$(o.BODY_SELECTOR).html("Are you sure you want to delete alert ("+a.entry.get("name")+")?"),this.id=e,this.alert=a),this.show()},showJobModeChangeConfirm:function(t,e,n,a){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html(t+" job"),this.$(".btn-primary").html(t),this.$(".btn-primary").addClass("change-job-mode"),this.$(o.BODY_SELECTOR).html("Are you sure you want to "+t.toLowerCase()+" job("+n+") ?"),this.id=e,this.mode=a,this.show()},showJobEditConfirm:function(t){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html("Edit job"),this.$(".btn-primary").html("Edit"),this.$(".btn-primary").addClass("edit-job"),this.$(o.BODY_SELECTOR).html("Another job ("+t+") has been saved with same search. <br>Do you want to edit this job?"),this.name=t,this.show()},showUpgradeInfo:function(){this._clean(),this.$(o.HEADER_TITLE_SELECTOR).html("Information");var t=a.buildLinkNode(i.AWS_BEFORE_UPGRADE),e=a.buildLinkNode(i.AWS_AFTER_UPGRADE);this.$(o.BODY_SELECTOR).html("You installed the Splunk App for AWS version 6.0.3<br><br> Confirm you migrated the indexes for the app and disabled the required saved searches. "+t+"<br><br>Now, enable data model acceleration, schedule reports, and update the aws-data-model-acceleration search macro. "+e),this.show()},_clean:function(){this.$(".btn-primary").removeClass(u.join(" ")),this.$(".create-job").hide()}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=u},function(t,e,n){var a,i;a=[],i=function(){return{MILLI_SEC_IN_SEC:1e3,MILLI_SEC_IN_MIN:6e4,MILLI_SEC_IN_HOUR:36e5,MILLI_SEC_IN_DAY:864e5,DAY_IN_WEEK:7,DAY_IN_MONTH:30,OUTLIER_COLOR:"#ff0000",NORMAL_COLORS:["#d6563c","#1e93c6","#f2b827","#6a5c9e","#31a35f","#3863a0","#a2cc3e","#ed8440","#cc5068","#73427f","#11a88b","#99712b","#314d5b"],ENABLE_MODE:1,DETECT_MODE:2,DISPLAY_MODE:4,HIGHLIGHT_MODE:8,CREATE_MODE:16,EDIT_MODE:32,INDEX:"summary",SOURCE_TYPE:"aws:anomaly",JOB_ID:"job_id",JOB_NAME:"job_name",JOB_PRIORITY:"job_priority",JOB_MODE:"job_mode",JOB_SCHEDULE:"job_schedule",JOB_SEARCH:"job_search",JOB_TRAIN:"job_train",JOB_TAGS:"job_tags",JOB_ALERT_ID:"job_alert_id",JOB_DESCRIPTION:"job_description",INVALID_SEVERITY_COLOR:"#333",SEVERITY_COLOR_MAP:{1:"#FCE9E5",2:"#fed1c8",3:"#fa8e81",4:"#F14E3B"},UPDATE_SCHEDULE_CHECKER_JOB_SPL:'| inputlookup anomaly_schedule_checker | where job_id!="<%= jobId %>" | outputlookup anomaly_schedule_checker',UPDATE_SCHEDULE_CHECKER_ALERT_SPL:'| inputlookup anomaly_schedule_checker | where job_id!="<%= jobId %>" OR is_alert!="1" | outputlookup anomaly_schedule_checker',DAILY_TIME_FORMAT:"YYYY-MM-DD",HOURLY_TIME_FORMAT:"YYYY-MM-DD HH:mm:ss"}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(2),n(7),n(73),n(75)],i=function(t,e,n,a,i){"use strict";var r=(n.MultiSelectView,i.list_of_ids_with_all),o=i.list_of_ids_without_all;Object.keys(e.Components.attributes).forEach(function(t){for(var n=e.Components.get(t),i=t,s=0;s<r.length;s++)i.search(r[s])!=-1&&(n.val=a.multiSelectVal_persist_all);for(var l=0;l<o.length;l++)i.search(o[l])!=-1&&(n.val=a.multiSelectVal)})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(4),n(74)],i=function(t,e){return{multiSelectVal:function(){var n=arguments[0];if(t.isArray(n)&&n.length>1){var a=n.indexOf("*");0===a?n=t.without(n,"*"):a===n.length-1&&(n=["*"]),arguments[0]=n}return e.prototype.val.apply(this,arguments)},multiSelectVal_persist_all:function(){var n=arguments[0];if(t.isArray(n)&&0==n.length&&(arguments[0]="*"),t.isArray(n)&&n.length>1){var a=n.indexOf("*");0===a?n=t.without(n,"*"):a===n.length-1&&(n=["*"]),arguments[0]=n}return e.prototype.val.apply(this,arguments)}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports=p},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=["ip1","ip2","ip3","region","account"],a=["input1_all","input2_all","recommendation_filter","select_severity"];e.list_of_ids_without_all=n,e.list_of_ids_with_all=a},function(t,e,n){var a=n(77);"string"==typeof a&&(a=[[t.id,a,""]]);n(25)(a,{});a.locals&&(t.exports=a.locals)},function(t,e,n){e=t.exports=n(24)(),e.push([t.id,".single-total{position:relative;text-align:center;font-size:.8vw;font-weight:200!important;line-height:.8vw;color:grey;font-family:Roboto,Droid,Helvetica Neue,Helvetica,Arial,sans-serif}td.data-bar-cell{padding:1px 8px!important}.data-bar-wrapper{background-color:#eee;box-shadow:inset 0 1px 2px rgba(0,0,0,.1);margin-bottom:4px}td.data-bar-cell .data-bar-wrapper .data-bar{min-width:1px;color:#31708f;background-color:#428bca;box-shadow:inset 0 -1px 0 rgba(0,0,0,.3);border-right:1px solid #bb401f}.data-bar-custom-text{margin-right:2px;margin-top:3px;padding-top:2px;padding-bottom:2px;text-align:right}.data-bar-badge{background-color:#fff;border:1px solid #d3d3d3;border-radius:2px;color:purple;opacity:.88;padding-left:2px;padding-right:2px}td.range-low{background-color:#dff0d8!important;color:#3c763d!important;font-weight:700}td.range-elevated{background-color:#fcf8e3!important;color:#8a6d3b!important;font-weight:700}td.range-severe{background-color:#f2dede!important;color:#a94442!important;font-weight:700}td.range-unauth{font-weight:700;color:#d9534f!important}td.range-auth{font-weight:700;color:#428bca!important}td.range-err{font-weight:700;color:orange!important}td.inbound{background-color:#d9edf7!important;border-color:#bce8f1!important;color:#31708f!important}td.inbound,td.outbound{font-weight:700!important}td.outbound{background-color:#f5e0ec!important;border-color:#bda8b3!important;color:#7e6974!important}#awstags{display:inline-block;margin-right:10px}.tag-autocomplete{position:absolute;z-index:999;border:1px solid rgba(82,168,236,.8);background-color:#fff;margin-top:-9px;width:218px;max-height:200px;overflow-y:auto;display:none}.tag-autocomplete>ul{list-style-type:none;margin:0}.tag-autocomplete>ul>li{border-top:1px dotted #ccc;color:#1e93c6;padding-left:5px;line-height:23px;cursor:pointer}.tag-autocomplete>ul>li.active,.tag-autocomplete>ul>li:hover{background-color:rgba(0,0,0,.05)}.tag-autocomplete>ul>li.tag-loading{cursor:default;color:#000}.tag-autocomplete>ul>li.tag-loading>.loading-img{width:16px;height:16px;margin-top:2px;margin-right:5px;display:block;float:left;background-image:url("+n(78)+")}.hide-messages{margin-left:30px;margin-bottom:10px;display:inline-block}.sourcetype-checker{margin-bottom:0}.slidenavList.scroll-group{max-height:350px!important}","",{version:3,sources:["/./package/appserver/static/pcss/dashboards/SingleValueRenderer.pcss","/./package/appserver/static/pcss/dashboards/TableBarRenderer.pcss","/./package/appserver/static/pcss/dashboards/TableCellRenderer.pcss","/./package/appserver/static/pcss/dashboards/TagInputView.pcss","/./package/appserver/static/pcss/dashboards/MessageView.pcss","/./package/appserver/static/pcss/dashboards/common.pcss"],names:[],mappings:"AAAA,cACI,kBAAmB,AACnB,kBAAmB,AACnB,eAAiB,AACjB,0BAA4B,AAC5B,iBAAmB,AACnB,WAAY,AACZ,kEAA0E,CAC7E,ACRD,iBACI,yBAA4B,CAC/B,AAED,kBACI,sBAA0B,AAC1B,0CAA+C,AAC/C,iBAAmB,CACtB,AAED,6CACI,cAAe,AACf,cAAe,AACf,yBAA0B,AAC1B,yCAA+C,AAC/C,8BAAgC,CACnC,AAED,sBACI,iBAAkB,AAClB,eAAgB,AAChB,gBAAiB,AACjB,mBAAoB,AACpB,gBAAkB,CACrB,AAED,gBACI,sBAAuB,AACvB,yBAA0B,AAC1B,kBAAmB,AACnB,aAAe,AACf,YAAc,AACd,iBAAkB,AAClB,iBAAmB,CACtB,AChCD,aACI,mCAAqC,AACrC,wBAA0B,AAC1B,eAAkB,CACrB,AAED,kBACI,mCAAqC,AACrC,wBAA0B,AAC1B,eAAkB,CACrB,AAED,gBACI,mCAAqC,AACrC,wBAA0B,AAC1B,eAAkB,CACrB,AAED,gBACI,gBAAkB,AAClB,uBAA0B,CAC7B,AAED,cACI,gBAAkB,AAClB,uBAA0B,CAC7B,AAED,aACI,gBAAkB,AAClB,sBAAyB,CAC5B,AAED,WACI,mCAAqC,AACrC,+BAAiC,AACjC,uBAA0B,CAE7B,AAED,uBAHI,yBAA6B,CAQhC,AALD,YACI,mCAAqC,AACrC,+BAAiC,AACjC,uBAA0B,CAE7B,AC/CD,SACI,qBAAsB,AACtB,iBAAmB,CACtB,AAED,kBACI,kBAAmB,AACnB,YAAa,AACb,qCAA0C,AAC1C,sBAAwB,AACxB,gBAAiB,AACjB,YAAa,AACb,iBAAkB,AAClB,gBAAiB,AACjB,YAAc,CAuCjB,AAnCG,qBACI,qBAAsB,AACtB,QAAU,CAgCb,AA9BG,wBACI,2BAA4B,AAC5B,cAAe,AACf,iBAAkB,AAClB,iBAAkB,AAClB,cAAgB,CAwBnB,AAlBG,6DACI,gCAAsC,CACzC,AAED,oCACI,eAAgB,AAChB,UAAa,CAWhB,AATG,iDACI,WAAY,AACZ,YAAa,AACb,eAAgB,AAChB,iBAAkB,AAClB,cAAe,AACf,WAAY,AACZ,8CAAkD,CACrD,ACjDjB,eACI,iBAAkB,AAClB,mBAAoB,AACpB,oBAAsB,CACzB,AAED,oBACI,eAAmB,CACtB,ACFD,2BACI,0BAA4B,CAC/B",
file:"common.pcss",sourcesContent:['.single-total {\n    position: relative;\n    text-align: center;\n    font-size: 0.8vw;\n    font-weight: 200 !important;\n    line-height: 0.8vw;\n    color: grey;\n    font-family: "Roboto","Droid","Helvetica Neue",Helvetica,Arial,sans-serif;\n}',"td.data-bar-cell {\n    padding: 1px 8px !important;\n}\n\n.data-bar-wrapper {\n    background-color: #eeeeee;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) inset;\n    margin-bottom: 4px;\n}\n\ntd.data-bar-cell .data-bar-wrapper .data-bar {\n    min-width: 1px;\n    color: #31708F;\n    background-color: #428bca;\n    box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.30) inset;\n    border-right: 1px solid #bb401f;\n}\n\n.data-bar-custom-text {\n    margin-right: 2px;\n    margin-top: 3px;\n    padding-top: 2px;\n    padding-bottom: 2px;\n    text-align: right;\n}\n\n.data-bar-badge {\n    background-color: #fff;\n    border: 1px solid #d3d3d3;\n    border-radius: 2px;\n    color: #800080;\n    opacity: 0.88;\n    padding-left: 2px;\n    padding-right: 2px;\n}","/* Cell Highlighting */\n\ntd.range-low {\n    background-color: #DFF0D8 !important;\n    color: #3C763D !important;\n    font-weight: bold;\n}\n\ntd.range-elevated {\n    background-color: #FCF8E3 !important;\n    color: #8A6D3B !important;\n    font-weight: bold;\n}\n\ntd.range-severe {\n    background-color: #F2DEDE !important;\n    color: #A94442 !important;\n    font-weight: bold;\n}\n\ntd.range-unauth {\n    font-weight: bold;\n    color: #d9534f !important;\n}\n\ntd.range-auth {\n    font-weight: bold;\n    color: #428bca !important;\n}\n\ntd.range-err {\n    font-weight: bold;\n    color: orange !important;\n}\n\ntd.inbound {\n    background-color: #D9EDF7 !important;\n    border-color: #BCE8F1 !important;\n    color: #31708F !important;\n    font-weight: bold !important;\n}\n\ntd.outbound {\n    background-color: #F5E0EC !important;\n    border-color: #BDA8B3 !important;\n    color: #7E6974 !important;\n    font-weight: bold !important;\n}\n\n",'#awstags {\n    display: inline-block;\n    margin-right: 10px;\n}\n\n.tag-autocomplete {\n    position: absolute;\n    z-index: 999;\n    border: 1px solid rgba(82, 168, 236, 0.8);\n    background-color: white;\n    margin-top: -9px;\n    width: 218px;\n    max-height: 200px;\n    overflow-y: auto;\n    display: none;\n\n\n\n    > ul {\n        list-style-type: none;\n        margin: 0;\n\n        > li {\n            border-top: 1px dotted #ccc;\n            color: #1e93c6;\n            padding-left: 5px;\n            line-height: 23px;\n            cursor: pointer;\n\n            &.active {\n                background-color: rgba(0, 0, 0, 0.05);\n            }\n\n            &:hover {\n                background-color: rgba(0, 0, 0, 0.05);\n            }\n\n            &.tag-loading {\n                cursor: default;\n                color: black;\n\n                > .loading-img {\n                    width: 16px;\n                    height: 16px;\n                    margin-top: 2px;\n                    margin-right: 5px;\n                    display: block;\n                    float: left;\n                    background-image: url("../../img/loading-16.gif");\n                }\n            }\n        }\n    }\n}\n',".hide-messages {\n    margin-left: 30px;\n    margin-bottom: 10px;\n    display: inline-block;\n}\n\n.sourcetype-checker {\n    margin-bottom: 0px;\n}",'@import "./SingleValueRenderer.pcss";\n@import "./TableBarRenderer.pcss";\n@import "./TableCellRenderer.pcss";\n@import "./TagInputView.pcss";\n@import "./MessageView.pcss";\n\n.slidenavList.scroll-group{\n    max-height:350px !important;\n}'],sourceRoot:"webpack://"}])},function(t,e){t.exports="data:image/gif;base64,R0lGODlhEAAQAPIFANLS0qmpqVhYWCAgIIKCgu7u7v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUAo/eHBhY2tldCBiACH5BAkKAAUALAAAAAAQABAAAAMiWLo1KiwuV4CUDhZyZ4FcF4VFIC6Aea4d4LpsLM90bd9MAgAh+QQJCgAGACwEAAAACwAGAAADFjhmsrRLMfNgnDVA1Za21lcA4AKQRgIAIfkECQoABQAsAgAAAAsABQAAAxRYJUoaKrYC4lDMQVoudEqlXJKYAAAh+QQJCgAFACwAAAAACwAGAAADFVhapKFgFeNkEaq9uLBeQ2cpQzgWCQAh+QQJCgAHACwAAAAACAAIAAADFnh6obCnOEVUe5QdIFaFggGNy2AOUAIAIfkECQoABgAsAAAAAAYACwAAAxVoarCuQTVoClmR3beEF5wzDMoALgkAIfkECQoABQAsAAACAAUACwAAAxJYBdocbsHWiCWUClG4Gg34KQkAIfkECQoABgAsAAAEAAYACwAAAxQItlzK0IQZYiRkkWoE9Aw4RCMzJgAh+QQJCgAGACwAAAcACAAJAAADFggK1v4vhMgMgdYUM9o1AoeJTkhCQwIAIfkECQoABQAsAAAJAAsABwAAAxdYBaCuTYVHpxJlOEsK1pThUUo3ZuRZJAAh+QQJCgAHACwCAAoACwAGAAADGHgH2tNMkWPOi+FMoZ4q2gE2RxYeHCmpCQAh+QQJCgAFACwEAAkACwAHAAADF1i6FcNMrKdCK3KBS1QuxgUVm9iN1pgAACH5BAkKAAUALAcABwAJAAkAAAMXWFrTvTAWISRRpoISyl1b54FYtHGmpCQAIfkECQoABgAsCQAEAAcACwAAAxRoqrPQK0ZBqYyFxLB0MZyjhJcYJQAh+QQFCgAFACwKAAIABgALAAADFlg1qtyviCZmu4VojZUJDdCAhYiZRQIAOw=="},,function(t,e,n){var a,i,r=function(){function t(t,e){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){i=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();a=[n(29),n(4),n(7),n(81)],i=function(t,e,n,a){"use strict";var i=n.moment,o={generateIHSPL:function(n){var o=n.aws_account_id,s=n.region,l=n.instance_type,c=n.platform,d=n.tenancy,u=n.base,p=n.normalFactor,h=n.dedupSpl,f=a.RI,A=s+"*",g=l,m="";if(this.checkSizeFlexibility(c,d)){f=a.SIZE_FLEXIBILITY_RI;var _=l.split("."),y=r(_,2),v=y[0];y[1];g=v+"*",m=p}var C={dedupSpl:h,region:s,platform:c,tenancy:d,accountId:o,location:A,type:g,refer:m},b=e.template(f,t.extend({slice:"h",name:"current_ih"},C));if("prediction"===u){var E=i().add(1,"y").isLeapYear(),I=a.ONE_YEAR_DAY+(E?1:0);b+=e.template(a.PREDICT_RI,{oneYearHour:I*a.ONE_DAY_HOUR,oneYearDay:I,instanceHourSPL:e.template(f,t.extend({slice:"d",name:"current_d"},C))})}return b},generateRecommSPL:function(t){var e=t.base,n=t.payment,a=t.instance_type,i=t.region,r=t.platform,o=t.tenancy;return"| rirecommendation "+e+" "+i+" "+a+" "+n+' "'+r+'" "'+o+'"'},generateRISPL:function(t){return o.generateIHSPL(t)+o.generateRecommSPL(t)},calRI:function(t,e,n){if(0===n)return 0;var a=t.slice().sort(function(t,e){return t-e}),i=parseInt(e/n*t.length),r=Math.min(Math.max(t.length-i-1,0),t.length-1);return parseInt(Math.round(a[r]))},calRICost:function(t,e,n,i){var r=t.map(function(t){return parseFloat(t)}),o=r.reduce(function(t,e){return t+e},0),s=r.reduce(function(t,n){var a=n-e;return t+(a>0?a:0)},0),l=o*i,c=s*i+e*n*t.length;return t.length<a.ONE_YEAR_DAY*a.ONE_DAY_HOUR&&(l=parseInt(Math.round(l/t.length*a.ONE_YEAR_DAY*a.ONE_DAY_HOUR)),c=parseInt(Math.round(c/t.length*a.ONE_YEAR_DAY*a.ONE_DAY_HOUR)),s=parseInt(Math.round(s/t.length*a.ONE_YEAR_DAY*a.ONE_DAY_HOUR))),{onDemandCost:l,riCost:c,totalUnCoveredHours:s}},timeToIndex:function(t){return Math.floor((t-o.start.getTime())/a.ONE_DAY_MIS)},addPlotLine:function(e,n,a,i,r,o){var s={color:r,dashStyle:"shortdot",value:i,width:2,id:n,label:{rotation:0,text:a}};t.extend(s.label,o),e.addPlotLine(s)},timeToXText:function(t){return i(t).format("MMM DD,YYYY")},buildCacheId:function(t,e,n){var a=[n.aws_account_id,n.region,n.platform,n.tenancy,n.instance_type,t,e,n.regionLabel,n.platformLabel,n.tenancyLabel];return a.join("_")},_hoursWeightCmp:function(t,e){if(t.diff!==e.diff)return t.diff>e.diff?-1:1;if(t.value===e.value)return 0;var n=1,a=0,i=0;t.value>e.value?(n=-1,a=t.value,i=e.value):(a=e.value,i=t.value);var r=i/a,o=Math.floor(i+1)/(a<1?1:Math.floor(a)),s=Math.floor(i)/Math.floor(a+1),l=Math.abs(o-r),c=Math.abs(s-r);return l===c?0:l<c?n*-1:1*n},distributeDayAccordingHour:function(t,e){var n=this;if(0===t.length||0===e.length||t.length!==e.length/a.ONE_DAY_HOUR)return[];for(var i=Array.apply(null,Array(t.length*a.ONE_DAY_HOUR)).map(Number.prototype.valueOf,0),r=function(r){var o=Math.round(t[r]);if(0===o)return"continue";var s=o,l=[],c=e.slice(r*a.ONE_DAY_HOUR,(r+1)*a.ONE_DAY_HOUR),d=c.reduce(function(t,e){return t+e},0);c=c.map(function(t){return 0===d?1/a.ONE_DAY_HOUR:t/d});for(var u=0;u<a.ONE_DAY_HOUR;u++){i[r*a.ONE_DAY_HOUR+u]=Math.floor(c[u]*o);var p=c[u]*o-Math.floor(c[u]*o);s-=i[r*a.ONE_DAY_HOUR+u],l.push({index:u,diff:p,value:i[r*a.ONE_DAY_HOUR+u]})}if(s>0)for(l.sort(n._hoursWeightCmp);s>0&&l.length>0;)i[r*a.ONE_DAY_HOUR+l.shift().index]+=1,s-=1},o=0;o<t.length;o++){r(o)}return i},accumulateToMap:function(t,n,a){a=parseFloat(a),e.isNaN(a)&&(a=0);for(var i=t,r=0;r<n.length;r++)n[r]in i?r==n.length-1&&(i[n[r]]+=a):r==n.length-1?i[n[r]]=a:i[n[r]]={},i=i[n[r]]},getValueFromMap:function(t,e){for(var n=t,a=0;a<e.length;a++){if(!(e[a]in n))return 0;n=n[e[a]]}return n},checkSizeFlexibility:function(t,e){return"Linux"==t&&"On Demand"==e}};return o}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i,r;i=[n(9)],r=function(t){var e;return e={ONE_YEAR_DAY:365,ONE_DAY_HOUR:24,ONE_HOUR_SECOND:3600,ONE_YEAR_MONTH:12,ONE_DAY_MIS:864e5,ONE_HOUR_MIS:36e5,TIMESTAMP_TO_SPLUNK_TIME_COEF:.001,DEFAULT_SMALLEST_SIZE:"small",CHART_CONTAINER_ID:"chartContainer",DEDUP_PREFIX:"instance_hour_cur.",EVENT:{DRAG_POINT:"point",SELECT_TIME:"time",RESET:"reset"},NO_DESCRIPTION_MESSAGE:"It requires description data to get existing reserved instance information.",PARAM:'| tstats `aws-data-model-acceleration` count FROM datamodel=Instance_Hour_CUR where instance_hour_cur.InvoiceId=* instance_hour_cur.AvailabilityZone!="Unspecified"  by instance_hour_cur.LinkedAccountId instance_hour_cur.instance_type instance_hour_cur.platform instance_hour_cur.tenancy instance_hour_cur.AvailabilityZone | rename instance_hour_cur.AvailabilityZone as availability_zone, instance_hour_cur.LinkedAccountId as aws_account_id,  instance_hour_cur.instance_type as instance_type, instance_hour_cur.platform as platform, instance_hour_cur.tenancy as tenancy | eval availability_zone_len=len(availability_zone), region=substr(availability_zone, 0, availability_zone_len-1)| lookup regions region OUTPUT label as regionLabel | lookup ri_billing_to_description billing as platform OUTPUT description as platformLabel | lookup ri_billing_to_description billing as tenancy OUTPUT description as tenancyLabel| stats count by aws_account_id, region, platform, tenancy, instance_type, regionLabel, platformLabel, tenancyLabel',RI:'| tstats `aws-data-model-acceleration` sum(instance_hour_cur.UsageAmount) as count FROM datamodel=Instance_Hour_CUR where instance_hour_cur.InvoiceId=* <%= dedupSpl %> AND instance_hour_cur.LinkedAccountId="<%= accountId %>"  AND instance_hour_cur.AvailabilityZone="<%= location %>" AND instance_hour_cur.instance_type="<%= type %>"  AND instance_hour_cur.platform="<%= platform %>" AND instance_hour_cur.tenancy="<%= tenancy %>" by instance_hour_cur.instance_type, _time span=1d | curdailytohourly| timechart span=1<%=slice %> sum(count) as <%=name %> | fillnull',SIZE_FLEXIBILITY_RI:'| tstats `aws-data-model-acceleration` sum(instance_hour_cur.UsageAmount) as count FROM datamodel=Instance_Hour_CUR where instance_hour_cur.InvoiceId=* <%= dedupSpl %> AND instance_hour_cur.LinkedAccountId="<%= accountId %>" AND instance_hour_cur.AvailabilityZone="<%= location %>" AND instance_hour_cur.instance_type="<%= type %>"  AND instance_hour_cur.platform="<%= platform %>" AND instance_hour_cur.tenancy="<%= tenancy %>" by instance_hour_cur.instance_type, _time span=1d | curdailytohourly | rename instance_hour_cur.instance_type as instance_type | eval size=split(instance_type, "."), size=mvindex(size, 1)| lookup ri_normal_factor size OUTPUT factor | eval unit = count * factor / <%= refer %> | timechart span=1<%=slice %> sum(unit) as <%= name %> | fillnull',BILLING_REPORT_ENDTIME:"| inputlookup billing_report_assemblyid_cur | sort 0 - timestr",PREDICT_RI:"| predict current_ih as recommended_ih future_timespan=<%= oneYearHour %> | appendcols [<%= instanceHourSPL %> | predict current_d as recommended_d future_timespan=<%= oneYearDay %> | eval d_time=_time]",BOUGHT_RI:'`aws-description-resource("*", "*", "ec2_reserved_instances")` | search state="active" | stats sum(instance_count) as instance_count by aws_account_id, region, description, instance_tenancy, Scope, instance_type | rename description as platform, instance_tenancy as tenancy',FLEXIBILITY_FAMILY_INFO:'| inputlookup price | append [|inputlookup cn_price] | where os="Linux" AND tenancy="Shared" | sort on_demand_hourly | eval instance_type=split(instance_type,"."), family=mvindex(instance_type,0), size=mvindex(instance_type,1) | fields region, family, size | mvcombine size',NORMAL_FACTOR:"| inputlookup ri_normal_factor"},a(e,"EVENT",{DRAG_POINT:"point",SELECT_TIME:"time",RESET:"reset"}),a(e,"TABLE",{SORT_INDEX:[8,7,6],EXISTING_RI_INDEX:6,OPTIMAL_RI_INDEX:7,YEARLY_SAVING_INDEX:8,MESSAGE_INDEX:9,MESSAGE:"Details",ITEM_NAME:{SINGLE:"item",PLURAL:"items"},columnName:["","Account ID","Region","Platform","Tenancy","Instance type","Existing RIs","Optimal RIs","Estimated yearly savings","Details"],columnType:[["expand"],["sort"],["sort"],["sort"],["sort"],["sort"],["sort","tooltip"],["sort","headerTooltip","tooltip"],["sort"],["tooltip","drilldown"]],headerParams:{"Optimal RIs":{tooltipTemplate:t}},footerParams:{"":{colspan:8},"Estimated yearly savings":{colspan:2}},columnParams:{Details:{tooltipPlacement:"top",tooltipOnClick:"return false;"},"Existing RIs":{tooltipPlacement:"top",tooltipOnClick:"return false;"},"Optimal RIs":{tooltipPlacement:"top",tooltipOnClick:"return false;"}}}),a(e,"FILTERS",{BASE_OPTIONS:[{value:"history",label:"History"},{value:"prediction",label:"Prediction"}],PAYMENT_OPTIONS:[{value:"all",label:"All upfront"},{value:"partial",label:"Partial upfront"},{value:"no",label:"No upfront"}]}),e}.apply(e,i),!(void 0!==r&&(t.exports=r))},,,,,function(t,e,n){var a,i;a=[n(4),n(5),n(7),n(87),n(89)],i=function(t,e,n,a,i){var r=n.BaseView;return r.extend({initialize:function(){r.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"change:filtersEnabled",this._changeFiltersState.bind(this))},_changeFiltersState:function(){this.model.get("filtersEnabled")?this.filterView.enableFilters():this.filterView.disableFilters()},render:function(){return this.$el.html("<div id='infoContainer'></div><div id='filterContainer'></div>"),this.infoView=new a({el:this.$("#infoContainer")}).render(),this.filterView=new i({el:this.$("#filterContainer")}).render(),this}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i,r=function(){function t(t,e){var n=[],a=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);a=!0);}catch(t){i=!0,r=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();a=[n(4),n(5),n(7),n(2),n(6),n(88)],i=function(t,e,n,a,i,o){"use strict";var s=n.BaseView;return s.extend({tagName:"div",initialize:function(){s.prototype.initialize.apply(this,arguments),this.tokens=a.Components.get("default")},render:function(){var e=i.checkSizeFlexibility(this.tokens.get("platform"),this.tokens.get("tenancy")),n=this.tokens.get("instance_type").split("."),a=r(n,2),s=a[0];a[1];return this.$el.html(t.template(o,{accountId:this.tokens.get("accountId"),platform:this.tokens.get("platformLabel"),tenancy:this.tokens.get("tenancyLabel"),region:this.tokens.get("regionLabel"),type:this.tokens.get("instance_type"),applyFlexibility:e,family:s})),this}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e){t.exports="<div>Summary</div>\n<table>\n        <tr>\n          <td>Account ID:</td>\n          <td><strong><%= accountId %></strong></td>\n        </tr>\n        <tr>\n            <td>Region:</td>\n            <td><strong><%= region %></strong></td>\n        </tr>\n          <td>Platform:</td>\n          <td><strong><%= platform %></strong></td>\n        </tr>\n        <tr>\n          <td>Tenancy:</td>\n          <td><strong><%= tenancy %></strong></td>\n        </tr>\n        <tr>\n            <% if (applyFlexibility) {%>\n          <td>Family:</td>\n          <td><strong><%= family %></strong></td>\n            <% }else { %>\n            <td>Instance type:</td>\n          <td><strong><%= type %></strong></td>\n            <% } %>\n        </tr>\n        <tr>\n</table>"},function(t,e,n){var a,i;a=[n(29),n(4),n(5),n(2),n(7),n(11),n(8)],i=function(t,e,n,a,i,r,o){var s=i.BaseView,l=i.ControlGroup;return s.extend({initialize:function(){var t=this;s.prototype.initialize.apply(this,arguments),this.tokens=a.Components.get("default"),this.stateModel=new n.Model,this.stateModel.set("base",this.tokens.get("base")),this.stateModel.set("payment",this.tokens.get("payment")),this.stateModel.on("change:base",function(){t.tokens.set("base",t.stateModel.get("base"))}.bind(this)),this.stateModel.on("change:payment",function(){t.tokens.set("payment",t.stateModel.get("payment"))}.bind(this))},enableFilters:function(){this.baseRadio.enable(),this.paymentRadio.enable()},disableFilters:function(){this.baseRadio.disable(),this.paymentRadio.disable()},render:function(){this.$el.html('<div id="base-input" class="filter-input"></div><div id="payment-input" class="filter-input"></div>'),this.baseRadio=new l({el:t("#base-input"),label:"Basis for insight",controlType:"SyntheticRadio",controlOptions:{model:this.stateModel,modelAttribute:"base",items:o.FILTERS.BASE_OPTIONS}}),this.$el.append(this.baseRadio.render().$el),this.$("#base-input .control-label").append(" "+r),this.$('[data-toggle="tooltip"]').tooltip({container:"#headerContainer"}),this.paymentRadio=new l({el:t("#payment-input"),label:"Payment option(one-year term)",controlType:"SyntheticRadio",controlOptions:{model:this.stateModel,modelAttribute:"payment",items:o.FILTERS.PAYMENT_OPTIONS}}),this.$el.append(this.paymentRadio.render().$el),this.disableFilters()}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},,function(t,e){t.exports='<span data-html="true" class="icon-info-circle RI-formula-tooltip" data-toggle="tooltip" data-placement="bottom" data-original-title=\'\n<table>\n  <tr>\n    <th colspan="11">Recommened Cost =<div class="riCostSpan">RI Cost</div> + <div class="onDemandCostSpan">On Demand Cost</div></th>\n  </tr>\n  <tr>\n    <td><div class="riCostSpan">RI Cost</div></td>\n    <td>=</td>\n    <td class="formulaNum"><%=RI%></td>\n    <td>x</td>\n    <td class="formulaNum"><%=currencySign %><%=yearly%></td>\n    <td>+</td>\n    <td class="formulaNum"><%=RI%></td>\n    <td>x</td>\n    <td class="formulaNum"><%=currencySign %><%=monthly%></td>\n    <td>x</td>\n    <td class="formulaNum">12</td>\n  </tr>\n  <tr>\n    <td></td>\n    <td></td>\n    <td class="formulaConst">RI</td>\n    <td></td>\n    <td class="formulaConst">Reserved Yearly Cost</td>\n    <td></td>\n    <td class="formulaConst">RI</td>\n    <td></td>\n    <td class="formulaConst">Reserved Monthly Cost</td>\n    <td></td>\n    <td class="formulaConst">Months</td>\n  </tr>\n  <tr>\n    <td><div class="onDemandCostSpan">On Demand Cost</div></td>\n    <td>=</td>\n    <td class="formulaNum"><%=hours%></td>\n    <td>x</td>\n    <td class="formulaNum"><%=currencySign %><%=hourly%></td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n  </tr>\n  <tr>\n    <td></td>\n    <td></td>\n    <td class="formulaConst"><%= remainedDisplay %></td>\n    <td></td>\n    <td class="formulaConst">On-demand Hourly Cost</td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n    <td></td>\n  </tr>\n</table>\'></span>\n'},,,function(t,e,n){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i,r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();i=[n(4)],r=function(t){var e=function(){function t(){a(this,t)}return o(t,[{key:"reload",value:function(t){this.anchorList=[],this.startAnchor=t.start,this.endAnchor=t.end,this._insertList(this.anchorList,this.startAnchor),this._insertList(this.anchorList,this.endAnchor)}},{key:"dragStart",value:function(t,e){this.curIndex=t,this.oldY=e,this._insertList(this.anchorList,t)}},{key:"dragInProgress",value:function(t,e){var n=[],a=Math.max(this._findBiggestSmallerThanValue(this.anchorList,this.curIndex),0),i=Math.min(this._findSmallestBiggerThanValue(this.anchorList,this.curIndex),this.anchorList.length-1);if(this.startAnchor=this.anchorList[a],this.endAnchor=this.anchorList[i],this.startAnchor<this.curIndex){var r=this._calProportion(this.curIndex-this.startAnchor,e-this.oldY);this._floodToNeighbors(t,this.startAnchor,this.startAnchor+1,this.curIndex-1,r,n)}if(this.curIndex<this.endAnchor){var o=this._calProportion(this.curIndex-this.endAnchor,e-this.oldY);this._floodToNeighbors(t,this.endAnchor,this.curIndex+1,this.endAnchor-1,o,n)}return n}},{key:"deleteAnchor",value:function(t){if(t!==this.startAnchor&&t!==this.endAnchor){var e=this.anchorList.indexOf(t);e>-1&&this.anchorList.splice(e,1)}}},{key:"addAnchor",value:function(t){this._insertList(this.anchorList,t)}},{key:"_floodToNeighbors",value:function(t,e,n,a,i,r){for(var o=n;o<=a;o++){var s=Math.max(this._calDiff(o-e,i)+t[o],0);r.push({x:o,y:s})}}},{key:"_findBiggestSmallerThanValue",value:function(t,e){for(var n=t.length,a=0,i=n-1;a<=i;){var r=parseInt((a+i)/2);e<=t[r]?i=r-1:a=r+1}return i}},{key:"_findSmallestBiggerThanValue",value:function(t,e){for(var n=t.length,a=0,i=n-1;a<=i;){var r=parseInt((a+i)/2);e<t[r]?i=r-1:a=r+1}return a}},{key:"_insertList",value:function(t,e){for(var n=t.length,a=0,i=n-1;a<=i;){var r=parseInt((a+i)/2);if(e==t[r])return;e<t[r]?i=r-1:a=r+1}t.push(e);for(var o=n;o>a;o--){var s=t[o];t[o]=t[o-1],t[o-1]=s}}},{key:"_calDiff",value:function(t,e){return e*t}},{key:"_calProportion",value:function(t,e){return 0===t?0:e/t}}]),t}(),n=void 0;return{getInstance:function(){return n||(n=new e),n}}}.apply(e,i),!(void 0!==r&&(t.exports=r))},,function(t,e,n){var a=n(97);"string"==typeof a&&(a=[[t.id,a,""]]);n(25)(a,{});a.locals&&(t.exports=a.locals)},function(t,e,n){e=t.exports=n(24)(),e.push([t.id,"#headerContainer,.dashboard-row .dashboard-panel .panel-body.html{background-color:#eee;padding:0}.icon-info-circle{font-size:12px;cursor:pointer}.tooltip.in{opacity:.9;filter:alpha(opacity=90)}.hidden{display:none}#headerContainer .tooltip-inner,#ri .tooltip-inner{min-width:300px}#infoContainer{border-right:1px solid #ddd;padding-bottom:10px;float:left}#infoContainer tr>td:first-child{text-align:right}#infoContainer tr>td:last-child{padding-left:20px;padding-right:25px}#filterContainer{display:inline}#filterContainer .filter-input{display:inline-block;margin-left:20px}#filterContainer #base-input{width:164.5px}#filterContainer #payment-input{width:287px}#riCost .tooltip-inner{min-width:400px}#riCost .riCostSpan{background-color:#4a90e2;padding:1px 2px;display:inline}#riCost .onDemandCostSpan{background-color:#f07a35;padding:1px 2px;display:inline}#riCost .formulaNum{font-size:20px}#riCost #riCostContainer th{height:35px;text-align:left;valign:center;border-bottom:1px solid #9b9b9b}#riCost #riCostContainer td{width:4.5%;text-align:center}#riCost #riCostContainer td:first-child{width:29%;text-align:right}#riCost #riCostContainer td:nth-child(5){width:15%}#riCost #riCostContainer td:nth-child(9){width:20%}#riCost .formulaConst{font-size:10px;color:#9b9b9b}#chartContainer .chart-button{float:right;position:relative;top:-290px;right:10px;z-index:2}#message-view{background-color:#eee}","",{version:3,sources:["/./package/appserver/static/pcss/pages/insights/RI_planner_detail.pcss"],names:[],mappings:"AAAA,kEACI,sBAAuB,AACvB,SAAa,CAChB,AACD,kBACI,eAAgB,AAChB,cAAgB,CACnB,AACD,YACI,WAAa,AACb,wBAA0B,CAC7B,AACD,QACI,YAAc,CACjB,AAEG,mDACI,eAAiB,CACpB,AAEL,eACI,4BAA6B,AAC7B,oBAAqB,AACrB,UAAW,CAQd,AAPG,iCACI,gBAAkB,CACrB,AACD,gCACI,kBAAmB,AACnB,kBAAoB,CACvB,AAEL,iBACI,cAAgB,CAWnB,AAVG,+BACI,qBAAsB,AACtB,gBAAkB,CACrB,AACD,6BACI,aAAe,CAClB,AACD,gCACI,WAAa,CAChB,AAGD,uBACI,eAAiB,CACpB,AACD,oBACI,yBAAyB,AACzB,gBAAyB,AACzB,cAAgB,CACnB,AACD,0BACI,yBAAyB,AACzB,gBAAyB,AACzB,cAAgB,CACnB,AACD,oBACI,cAAgB,CACnB,AACD,4BACI,YAAa,AACb,gBAAiB,AACjB,cAAe,AACf,+BAAiC,CACpC,AACD,4BACI,WAAY,AACZ,iBAAmB,CACtB,AACD,wCACI,UAAW,AACX,gBAAkB,CACrB,AACD,yCACI,SAAW,CACd,AACD,yCACI,SAAW,CACd,AACD,sBACI,eAAe,AACf,aAAe,CAClB,AAGD,8BACI,YAAY,AACZ,kBAAkB,AAClB,WAAW,AACX,WAAY,AACZ,SAAU,CACb,AAEL,cACI,qBAAuB,CAC1B",file:"RI_planner_detail.pcss",sourcesContent:[".dashboard-row .dashboard-panel .panel-body.html, #headerContainer {\n    background-color: #eee;\n    padding: 0px;\n}\n.icon-info-circle {\n    font-size: 12px;\n    cursor: pointer;\n}\n.tooltip.in {\n    opacity: 0.9;\n    filter: alpha(opacity=90);\n}\n.hidden {\n    display: none;\n}\n#headerContainer, #ri {\n    .tooltip-inner {\n        min-width: 300px;\n    }\n}\n#infoContainer {\n    border-right: 1px solid #ddd;\n    padding-bottom: 10px;\n    float:left;\n    tr>td:first-child {\n        text-align: right;\n    }\n    tr>td:last-child {\n        padding-left: 20px;\n        padding-right: 25px;\n    }\n}\n#filterContainer {\n    display: inline;\n    .filter-input {\n        display: inline-block;\n        margin-left: 20px;\n    }\n    #base-input {\n        width: 164.5px;\n    }\n    #payment-input {\n        width: 287px;\n    }\n}\n#riCost {\n    .tooltip-inner {\n        min-width: 400px;\n    }\n    .riCostSpan {\n        background-color:#4a90e2;\n        padding: 1px 2px 1px 2px;\n        display: inline;\n    }\n    .onDemandCostSpan {\n        background-color:#f07a35;\n        padding: 1px 2px 1px 2px;\n        display: inline;\n    }\n    .formulaNum {\n        font-size: 20px;\n    }\n    #riCostContainer th {\n        height: 35px;\n        text-align: left;\n        valign: center;\n        border-bottom: 1px solid #9b9b9b;\n    }\n    #riCostContainer td {\n        width: 4.5%;\n        text-align: center;\n    }\n    #riCostContainer td:first-child {\n        width: 29%;\n        text-align: right;\n    }\n    #riCostContainer td:nth-child(5) {\n        width: 15%;\n    }\n    #riCostContainer td:nth-child(9) {\n        width: 20%;\n    }\n    .formulaConst {\n        font-size:10px;\n        color: #9b9b9b;\n    }\n}\n#chartContainer {\n    .chart-button {\n        float:right;\n        position:relative;\n        top:-290px;\n        right: 10px;\n        z-index:2;\n    }\n}\n#message-view {\n    background-color: #eee;\n}"],sourceRoot:"webpack://"}])},function(t,e,n){var a,i;a=[n(29),n(4),n(5),n(2),n(80),n(81)],i=function(t,e,n,a,i,r){return n.Model.extend({defaults:{hourlyData:null,singleData:null,dailyData:null,priceInfo:null,filtersEnabled:!1},changeSingleData:function(t){var e=this.get("hourlyData")[t];if("prediction"===t){var n=this.get("dailyData")[t].data;e=i.distributeDayAccordingHour(n,e)}this.set("singleData",e)},selectTimeToModifySingleData:function(t,e){var n=t*r.ONE_DAY_HOUR,a=(e+1)*r.ONE_DAY_HOUR;this.set("singleData",this.get("hourlyData").history.slice(n,a))},dragPointToModifySingleData:function(t){var e=this.get("hourlyData").prediction;this.set("singleData",i.distributeDayAccordingHour(t,e))}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i,r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();i=[n(29),n(4),n(2),n(33),n(80),n(81)],r=function(t,e,n,i,r,s){var l=function(){function l(e,i,r){var o=this;a(this,l),this.model=e,this.tokens=n.Components.get("default"),this.model.set("filtersEnabled",!1);var s=this.instanceHourSearch(i,r),c=this.riInfoSearch();t.when(s,c).done(function(){o.model.set("filtersEnabled",!0)}.bind(this))}return o(l,[{key:"instanceHourSearch",value:function(e,n){var a=this,o=t.Deferred(),s=decodeURIComponent(this.tokens.get("dedupSpl")),l={dedupSpl:s,aws_account_id:this.tokens.get("accountId"),region:this.tokens.get("region"),platform:this.tokens.get("platform"),tenancy:this.tokens.get("tenancy"),instance_type:this.tokens.get("instance_type"),normalFactor:this.tokens.get("normalFactor")};this.tokens.set("ihSearchSPL",r.generateIHSPL(t.extend({base:"history"},l)));var c=new i({id:"ihSearch",search:r.generateIHSPL(t.extend({base:"prediction"},l)),earliest_time:e,latest_time:n,preview:!1});return c.on("search:done",function(t){0===t.content.resultCount?o.resolve():!function(){var t=c.data("results",{output_mode:"json",count:0});t.once("data",function(){var e=t.data().results;a._parseSearchDataForChart(e),a._parseSearchDataForSingleViews(e),o.resolve()})}()}),o}},{key:"riInfoSearch",value:function(){var e=this,n=t.Deferred(),a=this,o={base:"",payment:"",region:this.tokens.get("region"),platform:this.tokens.get("platform"),tenancy:this.tokens.get("tenancy"),instance_type:this.tokens.get("instance_type")},s=r.generateRecommSPL(o),l=new i({id:"riInfoSearch",search:s,preivew:!1});return l.on("search:done",function(){var t=l.data("results",{output_mode:"json",count:0});t.once("data",function(){var a=t.data().results;e.model.set("priceInfo",{onDemandHourly:parseFloat(a[0].on_demand_hourly),reservedOneAllYearly:parseFloat(a[0].reserved_one_all_yearly),reservedOnePartialYearly:parseFloat(a[0].reserved_one_partial_yearly),reservedOnePartialHourly:parseFloat(a[0].reserved_one_partial_hourly),reservedOneNoHourly:parseFloat(a[0].reserved_one_no_hourly)}),n.resolve()}.bind(a))}.bind(a)),n}},{key:"_parseSearchDataForChart",value:function(t){var n=t.filter(function(t){return!e.isUndefined(t.recommended_d)}),a=t.filter(function(t){return!e.isUndefined(t.current_d)});n=n.slice(a.length);var i=a.map(function(t){return Math.max(Math.round(t.current_d,0))});r.start=new Date(a[0].d_time/s.TIMESTAMP_TO_SPLUNK_TIME_COEF);var o=n.map(function(t){return Math.max(Math.round(t.recommended_d),0)});this.model.set("dailyData",{history:{data:i,start:a[0].d_time/s.TIMESTAMP_TO_SPLUNK_TIME_COEF,end:a[a.length-1].d_time/s.TIMESTAMP_TO_SPLUNK_TIME_COEF},prediction:{data:o,start:n[0].d_time/s.TIMESTAMP_TO_SPLUNK_TIME_COEF,end:n[n.length-1].d_time/s.TIMESTAMP_TO_SPLUNK_TIME_COEF}})}},{key:"_parseSearchDataForSingleViews",value:function(t){var n=t.filter(function(t){return!e.isUndefined(t.current_ih)}),a=t.filter(function(t){return e.isUndefined(t.current_ih)});a=a.map(function(t){return Math.max(parseFloat(t.recommended_ih),0)}),n=n.map(function(t){return Math.max(parseInt(Math.round(parseFloat(t.current_ih))),0)}),this.model.set("hourlyData",{history:n,prediction:a}),this.model.changeSingleData(this.tokens.get("base"))}}]),l}();return l}.apply(e,i),!(void 0!==r&&(t.exports=r))},function(t,e,n){var a,i;a=[n(29),n(4),n(5),n(2),n(7),n(80),n(81),n(9),n(91)],i=function(t,e,n,a,i,r,o,s,l){var c=i.BaseView,d=a.Components.get("submitted");return c.extend({initialize:function(){c.prototype.initialize.apply(this,arguments),this.model=this.options.model,this.tokens=a.Components.get("default"),this.formula=null,this.applyFlexibility=r.checkSizeFlexibility(this.tokens.get("platform"),this.tokens.get("tenancy")),this.normalFactor=this.applyFlexibility?parseFloat(this.tokens.get("normalFactor")):1,this.listenTo(this.model,"change:singleData",this.formatData.bind(this)),this.listenTo(this.tokens,"change:base",this._updateDrilldown.bind(this)),this.listenTo(a.Components.get("existingRi"),"rendered",this._renderExistingRi.bind(this)),this.listenTo(a.Components.get("ri"),"rendered",this._renderRi.bind(this)),this.listenTo(a.Components.get("riCost"),"rendered",this._renderRiCost.bind(this));
},formatData:function(){var t=this.tokens.get("payment"),n=this.model.get("priceInfo"),a=this.model.get("singleData"),i=n.onDemandHourly,s=i*o.ONE_DAY_HOUR*o.ONE_YEAR_DAY,c=0;switch(t){case"all":i=n.reservedOneAllYearly/(o.ONE_DAY_HOUR*o.ONE_YEAR_DAY),s=n.reservedOneAllYearly;break;case"partial":i=n.reservedOnePartialYearly/(o.ONE_DAY_HOUR*o.ONE_YEAR_DAY)+n.reservedOnePartialHourly,s=n.reservedOnePartialYearly,c=n.reservedOnePartialHourly*o.ONE_DAY_HOUR*(o.ONE_YEAR_DAY/o.ONE_YEAR_MONTH);break;case"no":i=n.reservedOneNoHourly,s=0,c=n.reservedOneNoHourly*o.ONE_DAY_HOUR*(o.ONE_YEAR_DAY/o.ONE_YEAR_MONTH)}var u=parseInt(r.calRI(a,i,n.onDemandHourly)),p=r.calRICost(a,u,i,n.onDemandHourly),h=p.onDemandCost,f=p.riCost,A=p.totalUnCoveredHours;this.formula=e.template(l,{remainedDisplay:this.applyFlexibility?"Remained Units":"Remained Hours",RI:u*this.normalFactor,yearly:parseInt(s/this.normalFactor),monthly:parseFloat(c/this.normalFactor).toFixed(2),hours:parseInt(A*this.normalFactor),hourly:parseFloat(n.onDemandHourly/this.normalFactor).toFixed(2),currencySign:this.tokens.get("currency")}),this.tokens.set("ri",u*this.normalFactor),this.tokens.set("onDemandCost",h),this.tokens.set("riCost",f),this.tokens&&d&&d.set(this.tokens.toJSON())},_updateDrilldown:function(){var t=a.Components.getInstance("ri"),e=this.tokens.get("base");t.getVisualization(function(t){"history"===e?t.settings.set("drilldown","all"):t.settings.set("drilldown","none")})},_renderRi:function(){t("#ri .optimal-RI-tooltip").length<=0&&(t("#ri .dashboard-element-title").append(" "+s),t(".optimal-RI-tooltip").tooltip({container:"#ri"})),this.applyFlexibility&&t("#ri .under-label").length>0&&t("#ri .under-label").text("Unit")},_renderRiCost:function(){if(t("#riCost .delta-label").length>0){var n=t("#riCost .delta-label").text();n=n.indexOf("-")>=0?n.slice(1):n,t("#riCost .delta-label").text(n),t("#riCost text.delta-label").attr("fill","#5cc05c")}t("#riCost .delta-indicator polyline").length>0&&t("#riCost .delta-indicator polyline").attr({stroke:"#5cc05c"}),t("#riCost .delta-indicator line").length>0&&t("#riCost .delta-indicator line").attr({fill:"#5cc05c",stroke:"#5cc05c"}),t("#riCost .single-result-unit").length>0&&t("#riCost .single-result-unit").text(this.tokens.get("currency")),t("#riCost .RI-formula-tooltip").length>0&&(t("#riCost .tooltip").remove(),t("#riCost .RI-formula-tooltip").remove()),e.isEmpty(this.formula)||(t("#riCost .dashboard-element-title").append(" "+this.formula),t(".RI-formula-tooltip").tooltip({container:"#riCost"}))},_renderExistingRi:function(){this.applyFlexibility&&t("#existingRi .under-label").length>0&&t("#existingRi .under-label").text("Unit")}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(29),n(4),n(5),n(2),n(7),n(80),n(81),n(102),n(94),n(103)],i=function(t,e,n,a,i,r,o,s,l,c){var d=i.BaseView;return d.extend({events:{"click .btn":"reset"},initialize:function(){d.prototype.initialize.apply(this,arguments),this.model=this.options.model,this.tokens=a.Components.get("default"),this.chartData=null,this.chart=new c.Chart(s.CHART),this.helper=l.getInstance(),this.predictionDay=null,this.dragPredictionDay=null,this.historyLength=0;var e=r.checkSizeFlexibility(this.tokens.get("platform"),this.tokens.get("tenancy"));this.normalFactor=e?this.tokens.get("normalFactor"):1,t("#"+o.CHART_CONTAINER_ID).on(o.EVENT.DRAG_POINT,this._dragEnd.bind(this)),this.listenTo(this.model,"change:dailyData",this.drawChart.bind(this)),this.listenTo(this.tokens,"change:base",this.redrawChart.bind(this))},render:function(){this.$el.append('<div class="chart-button"><a class="btn btn-primary hidden">Reset</a></div>')},_formatData:function(){var n=this,a=this.model.get("dailyData"),i={min:a.history.start,max:a.history.end},l={min:a.history.start,max:a.prediction.end},c=e.template(s.HISTORY_SERIES.name,{historyFrom:r.timeToXText(a.history.start),historyTo:r.timeToXText(a.history.end)}),d=e.template(s.PREDICTION_SERIES.name,{predictionFrom:r.timeToXText(a.prediction.start),predictionTo:r.timeToXText(a.prediction.end)}),u={pointStart:a.history.start,pointInterval:o.ONE_DAY_MIS},p=a.history.data.slice(0).map(function(t){return t*n.normalFactor}),h=a.prediction.data.slice(0).map(function(t){return t*n.normalFactor});this.predictionDay=h.slice();var f=[t.extend({},s.HISTORY_SERIES,t.extend({},u,{name:c+"<br>Adjust the history time range<br>by horizontal dragging",data:p}))];this.historyLength=p.length;var A=h.length;h=Array(this.historyLength).fill(null).concat(h);var g=[t.extend({},s.HISTORY_SERIES,t.extend({},u,{name:c,data:p.concat(Array(A).fill(null))})),t.extend({},s.PREDICTION_SERIES,t.extend({},u,{name:d,data:h}))];this.chartData={historyMask:{id:"historyMask",from:a.history.start,to:a.history.end,color:"rgba(0, 0, 0, 0.05)"},reloadParams:{start:r.timeToIndex(a.prediction.start),end:this.historyLength+A-1},history:{xAxisParams:i,series:f},prediction:{xAxisParams:l,series:g},predictionData:h}},drawChart:function(){this.$(".btn").removeClass("hidden"),this.chart.reflow(),this.chart.setTitle(null,{text:""}),this._formatData(),this._baseDrawChart()},reset:function(){"history"===this.tokens.get("base")?this._removeMask():(this.chart.series[1].update({data:this.chartData.predictionData.slice()},!0),this.helper.reload(this.chartData.reloadParams)),this.trigger(o.EVENT.RESET)},_dragEnd:function(){for(var t=this.helper.startAnchor,e=this.helper.endAnchor,n=t;n<=e;n++)this.dragPredictionDay[n-this.historyLength]=parseFloat(this.chart.series[1].data[n].y)/this.normalFactor;this.trigger(o.EVENT.DRAG_POINT,this.dragPredictionDay)},_removeMask:function(){this.chart.xAxis[0].removePlotBand("selectionMask"),this.chart.xAxis[0].removePlotLine("maskLeftLine"),this.chart.xAxis[0].removePlotLine("maskRightLine")},redrawChart:function(){for(;this.chart.series.length>0;)this.chart.series[0].remove(!1);this._baseDrawChart()},_baseDrawChart:function(){var e=this;this.helper.reload(this.chartData.reloadParams);var n=this.tokens.get("base");this.chart.xAxis[0].update(this.chartData[n].xAxisParams),this.chartData[n].series.forEach(function(n){e.chart.addSeries(t.extend(!0,{},n),!1)}),this.chart.redraw(),"prediction"===n?(this._removeMask(),this.chart.xAxis[0].addPlotBand(this.chartData.historyMask),this.chart.pointer.zoomX=!1,this.dragPredictionDay=this.predictionDay.slice()):(this.chart.xAxis[0].removePlotBand("historyMask"),this.chart.pointer.zoomX=!0)}})}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(29),n(2),n(7),n(80),n(81)],i=function(t,e,n,a,i){var r=n.moment,o=e.Components.get("default"),s=a.checkSizeFlexibility(o.get("platform"),o.get("tenancy"));return{HISTORY_SERIES:{cursor:"pointer",name:"<strong>The past year</strong><br><%= historyFrom %>-<%= historyTo %>",inDrag:!1,color:"#4a90e2",marker:{symbol:"circle"}},PREDICTION_SERIES:{name:"<strong>The following year</strong><br><%= predictionFrom %>-<%= predictionTo %><br>Adjust the prediction line<br>by vertical dragging points",inDrag:!1,drag:!0,color:"#f07a35",dashStyle:"dash",marker:{symbol:"circle"},cursor:"ns-resize"},CHART:{chart:{renderTo:"chartContainer",animation:!1,height:300,zoomType:"x",events:{selection:function(e){if(e.xAxis){var n=e.xAxis[0],r=new Date(Math.floor(n.min/i.ONE_HOUR_MIS)*i.ONE_HOUR_MIS),o=new Date(Math.ceil(n.max/i.ONE_HOUR_MIS)*i.ONE_HOUR_MIS),s=this.xAxis[0];r=Math.max(s.min,r),o=Math.min(s.max,o),s.removePlotBand("selectionMask"),s.addPlotBand({id:"selectionMask",from:r,to:o,color:"rgba(0, 0, 0, 0.05)"}),s.removePlotLine("maskLeftLine"),s.removePlotLine("maskRightLine"),a.addPlotLine(s,"maskLeftLine",a.timeToXText(r),r,"#4a90e2",{textAlign:"right",y:15,x:-5,verticalAlign:"top"}),a.addPlotLine(s,"maskRightLine",a.timeToXText(o),o,"#4a90e2",{textAlign:"left",y:15,verticalAlign:"top"}),t("#chartContainer").trigger("time",[r,o])}return!1}},resetZoomButton:{theme:{display:"none"}}},yAxis:{min:0,minTickleInterval:1,title:{text:s?"Normalized Instances Hours in Unit":"Instances Hours in Count"}},xAxis:{title:{text:"Time"},type:"datatime",minRange:864e5,labels:{formatter:function(){return r(this.value).format("MMM DD,YYYY")}},tickPositioner:function(){var t=(this.max-this.min)/864e5===365?5:6,e=[],n=this.min,a=Math.ceil((this.max-this.min)/t);if(null!==this.min&&null!==this.max)for(n;n<=this.max;n+=a){var i=new Date(n);e.push(new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime())}return e}},credits:{enabled:!1},legend:{useHTML:!0,align:"right",verticalAlign:"middle",layout:"vertical",itemMarginTop:15,itemStyle:{fontWeight:"normal"}},tooltip:{backgroundColor:"#000000",formatter:function(){return.25*Math.round(this.y/.25)},style:{color:"#ffffff"}},title:{text:"Running instances over time",align:"left",style:{fontSize:"14px",fontWeight:"bold"}},subtitle:{text:"Loading...",align:"left",style:{fontSize:"12px"}},plotOptions:{line:{marker:{enabled:!1},point:{events:{mouseOver:function(t){if(!this.series.options.inDrag){var e=this.series.chart.xAxis[0],n=a.timeToXText(this.category);a.addPlotLine(e,"pointLine",n,this.x,this.series.color,{textAlign:"left",y:-10,verticalAlign:"bottom"})}},mouseOut:function(t){if(!this.series.options.inDrag){var e=this.series.chart.xAxis[0];e.removePlotLine("pointLine")}},click:function(t){if(null!==this.series.yData[0]){var e="search?q="+o.get("ihSearchSPL")+(" | eval ri="+o.get("ri")+' | rename current_ih as "Instance hour count", ri as "Optimal RI"');e+="&earliest="+this.category*i.TIMESTAMP_TO_SPLUNK_TIME_COEF+"&latest="+(this.category+i.ONE_DAY_MIS)*i.TIMESTAMP_TO_SPLUNK_TIME_COEF,window.open(e)}}}}}}}}}.apply(e,a),!(void 0!==i&&(t.exports=i))},function(t,e,n){var a,i;a=[n(29),n(94),n(80),n(81),n(7)],i=function(t,e,n,a,i){var r=i.HighCharts,o=e.getInstance();return r.Chart.prototype.callbacks.push(function(e){function i(t){var a=t.originalEvent||t,i=e.hoverPoint;if(null===a.target.getAttribute("class")&&i){var r=i.series.options;r.drag&&i.drag!==!1&&(c=i,d=t.pageY,u=c.plotY+(e.plotHeight-(c.yBottom||e.plotHeight)),p=c.series.data.map(function(t){return t.y}),o.dragStart(n.timeToIndex(c.x),c.y),h=c.series,e.series.forEach(function(t){t.options.inDrag=!0}),f=!0)}}function s(t){if(t.preventDefault(),c){f=!1;var n=t.pageY,a=d-n,i=u-a,r=Math.max(h.yAxis.toValue(i,!0),0),s={x:c.x,y:r},l=h.kdTree;c.update(s,!1),h.halo&&(h.halo=h.halo.destroy()),e.tooltip&&e.tooltip.refresh(c);var A=o.dragInProgress(p,r);A.forEach(function(t){h.data[t.x].update({x:h.data[t.x].category,y:t.y},!1)}),h.redraw(),h.kdTree=l}}function l(i){c&&(e.series.forEach(function(t){t.options.inDrag=!1}),f&&c.options.selected?(c.update({marker:{enabled:!1}}),c.options.selected=!1,o.deleteAnchor(n.timeToIndex(c.x))):(c.update({marker:{enabled:!0,radius:6}}),c.options.selected=!0,f?o.addAnchor(n.timeToIndex(c.x)):t("#"+a.CHART_CONTAINER_ID).trigger(a.EVENT.DRAG_POINT)),c=d=void 0)}var c=void 0,d=void 0,u=void 0,p=void 0,h=void 0,f=void 0;r.addEvent(e.container,"mousedown",i),r.addEvent(e.container,"mousemove",s),r.addEvent(e.container,"mouseup",l),r.addEvent(e.container,"mouseleave",l)}),r}.apply(e,a),!(void 0!==i&&(t.exports=i))}])});